<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Rye::Hop [Rye: Safely run SSH commands on a bunch of machines at the same time (from Ruby).]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <div class='name'>
          <span class='type'>Class</span>
          Rye::Hop
        </div>
        <ol class='paths'>
          <li>
            <a href="../../files/lib/rye/hop_rb.html">lib/rye/hop.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <h1><a href="Hop.html">Rye::Hop</a></h1>
            <p>
            The <a href="Hop.html">Rye::Hop</a> class represents a machine. This class
            allows boxes to by accessed via it.
            </p>
            <pre>rhop = Rye::Hop.new('firewall.lan')&#x000A;rbox = Rye::Box.new('filibuster', :via =&gt; rhop)&#x000A;rbox.uptime     # =&gt; 20:53  up 1 day,  1:52, 4 users</pre>
            <p>
            Or
            </p>
            <pre>rbox = Rye::Box.new('filibuster', :via =&gt; 'firewall.lan')</pre>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000211">new</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000226">==</a></li>
              <li><a href="#M000216">add_key</a></li>
              <li><a href="#M000215">add_keys</a></li>
              <li><a href="#M000220">connect</a></li>
              <li><a href="#M000208">debug?</a></li>
              <li><a href="#M000222">disconnect</a></li>
              <li><a href="#M000209">error?</a></li>
              <li><a href="#M000210">exception_hook=</a></li>
              <li><a href="#M000213">fetch_port</a></li>
              <li><a href="#M000197">host</a></li>
              <li><a href="#M000204">host=</a></li>
              <li><a href="#M000227">host_key</a></li>
              <li><a href="#M000207">info?</a></li>
              <li><a href="#M000225">inspect</a></li>
              <li><a href="#M000223">keys</a></li>
              <li><a href="#M000201">nickname</a></li>
              <li><a href="#M000203">nickname=</a></li>
              <li><a href="#M000198">opts</a></li>
              <li><a href="#M000205">opts=</a></li>
              <li><a href="#M000221">remove_hops!</a></li>
              <li><a href="#M000218">remove_key</a></li>
              <li><a href="#M000217">remove_keys</a></li>
              <li><a href="#M000200">root?</a></li>
              <li><a href="#M000214">ssh_config_options</a></li>
              <li><a href="#M000219">switch_user</a></li>
              <li><a href="#M000224">to_s</a></li>
              <li><a href="#M000199">user</a></li>
              <li><a href="#M000202">via</a></li>
              <li><a href="#M000206">via?</a></li>
              <li><a href="#M000212">via_hop</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>MAX_PORT</td>
                    <td>=</td>
                    <td class='context-item-value'>65535</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      The maximum port number that the gateway will attempt to use to forward
                      connections from.
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>MIN_PORT</td>
                    <td>=</td>
                    <td class='context-item-value'>1024</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      The minimum port number that the gateway will attempt to use to forward
                      connections from.
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='method public-class' id='method-M000211'>
                <a name='M000211'>      </a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(host, opts={})</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>host</tt> The hostname to connect to. Default: localhost.
                  
                  </li>
                  <li><tt>user</tt> The username to connect as. Default: SSH config file or
                  current shell user.
                  
                  </li>
                  <li><tt>opts</tt> a hash of optional arguments.
                  
                  </li>
                  </ul>
                  <p>
                  The <tt>opts</tt> hash excepts the following keys:
                  </p>
                  <ul>
                  <li>:port => remote server ssh port. Default: SSH config file or 22
                  
                  </li>
                  <li>:keys => one or more private key file paths (passwordless login)
                  
                  </li>
                  <li>:via => the <a href="Hop.html">Rye::Hop</a> to access this host through
                  
                  </li>
                  <li>:info => an IO object to print <a href="Box.html">Rye::Box</a> command info
                  to. Default: nil
                  
                  </li>
                  <li>:debug => an IO object to print <a href="Box.html">Rye::Box</a> debugging
                  info to. Default: nil
                  
                  </li>
                  <li>:error => an IO object to print <a href="Box.html">Rye::Box</a> errors to.
                  Default: STDERR
                  
                  </li>
                  <li>:getenv => pre-fetch <tt>host</tt> environment variables? (default: true)
                  
                  </li>
                  <li>:password => the user&#8217;s password (ignored if there&#8217;s a valid
                  private key)
                  
                  </li>
                  <li>:templates => the template engine to use for uploaded files. One of: :erb
                  (default)
                  
                  </li>
                  <li>:sudo => Run all commands via sudo (default: false)
                  
                  </li>
                  </ul>
                  <p>
                  NOTE: <tt>opts</tt> can also contain any parameter supported by
                  Net::SSH.start that is not already mentioned above.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000211-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000211-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 81</span>&#x000A; 81:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">opts</span>={})&#x000A; 82:       <span class="ruby-identifier">ssh_opts</span> = <span class="ruby-identifier">ssh_config_options</span>(<span class="ruby-identifier">host</span>)&#x000A; 83:       <span class="ruby-ivar">@rye_exception_hook</span> = {}&#x000A; 84:       <span class="ruby-ivar">@rye_host</span> = <span class="ruby-identifier">host</span>&#x000A; 85:       &#x000A; 86:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:user</span>]&#x000A; 87:         <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:user</span>]&#x000A; 88:       <span class="ruby-keyword kw">else</span>&#x000A; 89:         <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">ssh_opts</span>[<span class="ruby-identifier">:user</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>.<span class="ruby-identifier">user</span>&#x000A; 90:       <span class="ruby-keyword kw">end</span>&#x000A; 91:       &#x000A; 92:       <span class="ruby-comment cmt"># These opts are use by Rye::Box and also passed to</span>&#x000A; 93:       <span class="ruby-comment cmt"># Net::SSH::Gateway (and Net::SSH)</span>&#x000A; 94:       <span class="ruby-ivar">@rye_opts</span> = {&#x000A; 95:         <span class="ruby-identifier">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ssh_opts</span>[<span class="ruby-identifier">:port</span>],&#x000A; 96:         <span class="ruby-identifier">:keys</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>,&#x000A; 97:         <span class="ruby-identifier">:via</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,&#x000A; 98:         <span class="ruby-identifier">:info</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,&#x000A; 99:         <span class="ruby-identifier">:debug</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,&#x000A;100:         <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">STDERR</span>,&#x000A;101:         <span class="ruby-identifier">:getenv</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,&#x000A;102:         <span class="ruby-identifier">:templates</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:erb</span>,&#x000A;103:         <span class="ruby-identifier">:quiet</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>&#x000A;104:       }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)&#x000A;105: &#x000A;106:       <span class="ruby-ivar">@next_port</span> = <span class="ruby-constant">MAX_PORT</span>&#x000A;107: &#x000A;108:       <span class="ruby-comment cmt"># Close the SSH session before Ruby exits. This will do nothing</span>&#x000A;109:       <span class="ruby-comment cmt"># if disconnect has already been called explicitly. </span>&#x000A;110:       <span class="ruby-identifier">at_exit</span> { <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">disconnect</span> }&#x000A;111: &#x000A;112:       <span class="ruby-comment cmt"># Properly handle whether the opt :via is a +Rye::Hop+ or a +String+</span>&#x000A;113:       <span class="ruby-comment cmt"># and does nothing if nil</span>&#x000A;114:       <span class="ruby-identifier">via_hop</span>(<span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:via</span>))&#x000A;115: &#x000A;116:       <span class="ruby-comment cmt"># @rye_opts gets sent to Net::SSH so we need to remove the keys</span>&#x000A;117:       <span class="ruby-comment cmt"># that are not meant for it. </span>&#x000A;118:       <span class="ruby-ivar">@rye_safe</span>, <span class="ruby-ivar">@rye_debug</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:safe</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:debug</span>)&#x000A;119:       <span class="ruby-ivar">@rye_info</span>, <span class="ruby-ivar">@rye_error</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:info</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:error</span>)&#x000A;120:       <span class="ruby-ivar">@rye_getenv</span> = {} <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:getenv</span>) <span class="ruby-comment cmt"># Enable getenv with a hash</span>&#x000A;121:       <span class="ruby-ivar">@rye_ostype</span>, <span class="ruby-ivar">@rye_impltype</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:ostype</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:impltype</span>)&#x000A;122:       <span class="ruby-ivar">@rye_quiet</span>, <span class="ruby-ivar">@rye_sudo</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:quiet</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:sudo</span>)&#x000A;123:       <span class="ruby-ivar">@rye_templates</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:templates</span>)&#x000A;124:       &#x000A;125:       <span class="ruby-comment cmt"># Store the state of the terminal </span>&#x000A;126:       <span class="ruby-ivar">@rye_stty_save</span> = <span class="ruby-value">`stty -g`</span>.<span class="ruby-identifier">chomp</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>&#x000A;127:       &#x000A;128:       <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_templates</span>.<span class="ruby-identifier">nil?</span>&#x000A;129:         <span class="ruby-identifier">require</span> <span class="ruby-ivar">@rye_templates</span>.<span class="ruby-identifier">to_s</span>   <span class="ruby-comment cmt"># should be :erb</span>&#x000A;130:       <span class="ruby-keyword kw">end</span>&#x000A;131:       &#x000A;132:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:logger</span>] = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@rye_debug</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_debug</span> <span class="ruby-comment cmt"># Enable Net::SSH debugging</span>&#x000A;133:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>] = [<span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>]].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;134:       &#x000A;135:       <span class="ruby-comment cmt"># Just in case someone sends a true value rather than IO object</span>&#x000A;136:       <span class="ruby-ivar">@rye_debug</span> = <span class="ruby-constant">STDERR</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_debug</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">||</span> <span class="ruby-constant">DEBUG</span>&#x000A;137:       <span class="ruby-ivar">@rye_error</span> = <span class="ruby-constant">STDERR</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_error</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>&#x000A;138:       <span class="ruby-ivar">@rye_info</span> = <span class="ruby-constant">STDOUT</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>&#x000A;139:       &#x000A;140:       <span class="ruby-comment cmt"># Add the given private keys to the keychain that will be used for @rye_host</span>&#x000A;141:       <span class="ruby-identifier">add_keys</span>(<span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>])&#x000A;142:       &#x000A;143:       <span class="ruby-comment cmt"># From: capistrano/lib/capistrano/cli.rb</span>&#x000A;144:       <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-comment cmt"># so that Net::SSH prompts show up</span>&#x000A;145:       &#x000A;146:       <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ssh-agent info: #{Rye.sshagent_info.inspect}&quot;</span>&#x000A;147:       <span class="ruby-identifier">debug</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">inspect</span>&#x000A;148:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M000226'>
                <a name='M000226'>      </a>
                <div class='synopsis'>
                  <span class='name'>==</span>
                  <span class='arguments'>(other)</span>
                </div>
                <div class='description'>
                  <p>
                  Compares itself with the <tt>other</tt> box. If the hostnames are the same,
                  this will return true. Otherwise false.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000226-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000226-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 361</span>&#x000A;361:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)&#x000A;362:       <span class="ruby-ivar">@rye_host</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">host</span>&#x000A;363:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000216'>
                <a name='M000216'>      </a>
                <div class='synopsis'>
                  <span class='name'>add_key</span>
                  <span class='arguments'>(*keys)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="Hop.html#M000215">add_keys</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000215'>
                <a name='M000215'>      </a>
                <div class='synopsis'>
                  <span class='name'>add_keys</span>
                  <span class='arguments'>(*keys)</span>
                </div>
                <div class='description'>
                  <p>
                  Add one or more private keys to the list of key paths.
                  </p>
                  <ul>
                  <li><tt>keys</tt> is a list of file paths to private keys
                  
                  </li>
                  </ul>
                  <p>
                  Returns the instance of <a href="Box.html">Box</a>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000215-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000215-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 204</span>&#x000A;204:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_keys</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">keys</span>)&#x000A;205:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>] <span class="ruby-operator">||=</span> []&#x000A;206:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;207:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>].<span class="ruby-identifier">uniq!</span>&#x000A;208:       <span class="ruby-keyword kw">self</span> <span class="ruby-comment cmt"># MUST RETURN self</span>&#x000A;209:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000220'>
                <a name='M000220'>      </a>
                <div class='synopsis'>
                  <span class='name'>connect</span>
                  <span class='arguments'>(reconnect=true)</span>
                </div>
                <div class='description'>
                  <p>
                  Open an SSH session with +@rye_host+. This called automatically when you
                  the first comamnd is run if it&#8217;s not already connected. Raises a <a
                  href="NoHost.html">Rye::NoHost</a> exception if +@rye_host+ is not
                  specified. Will attempt a password login up to 3 times if the initial
                  authentication fails.
                  </p>
                  <ul>
                  <li><tt>reconnect</tt> Disconnect first if already connected. The default
                  
                  </li>
                  </ul>
                  <p>
                  is true. When set to false, connect will do nothing if already connected.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000220-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000220-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 246</span>&#x000A;246:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">connect</span>(<span class="ruby-identifier">reconnect</span>=<span class="ruby-keyword kw">true</span>)&#x000A;247:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">NoHost</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_host</span>&#x000A;248:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reconnect</span>&#x000A;249:       <span class="ruby-identifier">disconnect</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_ssh</span> &#x000A;250:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_via</span>&#x000A;251:         <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Opening connection to #{@rye_host} as #{@rye_user}, via #{@rye_via.host}&quot;</span>&#x000A;252:       <span class="ruby-keyword kw">else</span>&#x000A;253:         <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Opening connection to #{@rye_host} as #{@rye_user}&quot;</span>&#x000A;254:       <span class="ruby-keyword kw">end</span>&#x000A;255:       <span class="ruby-identifier">highline</span> = <span class="ruby-constant">HighLine</span>.<span class="ruby-identifier">new</span> <span class="ruby-comment cmt"># Used for password prompt</span>&#x000A;256:       <span class="ruby-identifier">retried</span> = <span class="ruby-value">0</span>&#x000A;257:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>].<span class="ruby-identifier">compact!</span>  <span class="ruby-comment cmt"># A quick fix in Windows. TODO: Why is there a nil?</span>&#x000A;258:       <span class="ruby-keyword kw">begin</span>&#x000A;259:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_via</span>&#x000A;260:           <span class="ruby-comment cmt"># tell the +Rye::Hop+ what and where to setup,</span>&#x000A;261:           <span class="ruby-comment cmt"># it returns the local port used</span>&#x000A;262:           <span class="ruby-ivar">@rye_localport</span> = <span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">fetch_port</span>(<span class="ruby-ivar">@rye_host</span>, <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:port</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-value">22</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:port</span>] )&#x000A;263:           <span class="ruby-ivar">@rye_ssh</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span>.<span class="ruby-identifier">start</span>(<span class="ruby-value str">&quot;localhost&quot;</span>, <span class="ruby-ivar">@rye_user</span>, <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@rye_localport</span>) <span class="ruby-operator">||</span> {}) &#x000A;264:         <span class="ruby-keyword kw">else</span>&#x000A;265:           <span class="ruby-ivar">@rye_ssh</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span>.<span class="ruby-identifier">start</span>(<span class="ruby-ivar">@rye_host</span>, <span class="ruby-ivar">@rye_user</span>, <span class="ruby-ivar">@rye_opts</span> <span class="ruby-operator">||</span> {}) &#x000A;266:         <span class="ruby-keyword kw">end</span>&#x000A;267:         <span class="ruby-identifier">debug</span> <span class="ruby-value str">&quot;starting the port forward thread&quot;</span>&#x000A;268:         <span class="ruby-identifier">port_loop</span>&#x000A;269:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">HostKeyMismatch</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;270:         <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">message</span>&#x000A;271:         <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\a&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-comment cmt"># Ring the bell</span>&#x000A;272:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">highline</span>.<span class="ruby-identifier">ask</span>(<span class="ruby-value str">&quot;Continue? &quot;</span>).<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">/\Ay|yes|sure|ya\z/i</span>)&#x000A;273:           <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:paranoid</span>] = <span class="ruby-keyword kw">false</span>&#x000A;274:           <span class="ruby-keyword kw">retry</span>&#x000A;275:         <span class="ruby-keyword kw">else</span>&#x000A;276:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">HostKeyMismatch</span>&#x000A;277:         <span class="ruby-keyword kw">end</span>&#x000A;278:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">AuthenticationFailed</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;279:         <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\a&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">retried</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-comment cmt"># Ring the bell once</span>&#x000A;280:         <span class="ruby-identifier">retried</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;281:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">STDIN</span>.<span class="ruby-identifier">tty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">retried</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>&#x000A;282:           <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Passwordless login failed for #{@rye_user}&quot;</span>&#x000A;283:           <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:password</span>] = <span class="ruby-identifier">highline</span>.<span class="ruby-identifier">ask</span>(<span class="ruby-value str">&quot;Password: &quot;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">echo</span> = <span class="ruby-value str">''</span> }.<span class="ruby-identifier">strip</span>&#x000A;284:           <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:auth_methods</span>] <span class="ruby-operator">||=</span> []&#x000A;285:           <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:auth_methods</span>].<span class="ruby-identifier">push</span> <span class="ruby-operator">*</span>[<span class="ruby-value str">'keyboard-interactive'</span>, <span class="ruby-value str">'password'</span>]&#x000A;286:           <span class="ruby-keyword kw">retry</span>&#x000A;287:         <span class="ruby-keyword kw">else</span>&#x000A;288:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">AuthenticationFailed</span>&#x000A;289:         <span class="ruby-keyword kw">end</span>&#x000A;290:       <span class="ruby-keyword kw">end</span>&#x000A;291:       &#x000A;292:       <span class="ruby-comment cmt"># We add :auth_methods (a Net::SSH joint) to force asking for a</span>&#x000A;293:       <span class="ruby-comment cmt"># password if the initial (key-based) authentication fails. We</span>&#x000A;294:       <span class="ruby-comment cmt"># need to delete the key from @rye_opts otherwise it lingers until</span>&#x000A;295:       <span class="ruby-comment cmt"># the next connection (if we switch_user is called for example).</span>&#x000A;296:       <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">:auth_methods</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:auth_methods</span>)&#x000A;297:       &#x000A;298:       <span class="ruby-keyword kw">self</span>&#x000A;299:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000208'>
                <a name='M000208'>      </a>
                <div class='synopsis'>
                  <span class='name'>debug?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000208-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000208-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 54</span>&#x000A;54:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">debug?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_debug</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000222'>
                <a name='M000222'>      </a>
                <div class='synopsis'>
                  <span class='name'>disconnect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Close the SSH session with +@rye_host+. This is called automatically at
                  exit if the connection is open.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000222-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000222-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 317</span>&#x000A;317:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disconnect</span>&#x000A;318:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">closed?</span>&#x000A;319:       <span class="ruby-keyword kw">begin</span>&#x000A;320:         <span class="ruby-identifier">debug</span> <span class="ruby-value str">&quot;removing active forwards&quot;</span>&#x000A;321:         <span class="ruby-identifier">remove_hops!</span>&#x000A;322:         <span class="ruby-identifier">debug</span> <span class="ruby-value str">&quot;killing port_loop @rye_port_thread&quot;</span>&#x000A;323:         <span class="ruby-ivar">@rye_port_thread</span>.<span class="ruby-identifier">kill</span>&#x000A;324:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">busy?</span>;&#x000A;325:           <span class="ruby-identifier">info</span> <span class="ruby-value str">&quot;Is something still running? (ctrl-C to exit)&quot;</span>&#x000A;326:           <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-identifier">timeout</span>(<span class="ruby-value">10</span>) <span class="ruby-keyword kw">do</span>&#x000A;327:             <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">loop</span>(<span class="ruby-value">0</span><span class="ruby-value">.3</span>) { <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">busy?</span>; }&#x000A;328:           <span class="ruby-keyword kw">end</span>&#x000A;329:         <span class="ruby-keyword kw">end</span>&#x000A;330:         <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Closing connection to #{@rye_ssh.host}&quot;</span>&#x000A;331:         <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">close</span>&#x000A;332:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_via</span>&#x000A;333:           <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;disconnecting Hop #{@rye_via.host}&quot;</span>&#x000A;334:           <span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">disconnect</span>&#x000A;335:         <span class="ruby-keyword kw">end</span>&#x000A;336:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;337:         <span class="ruby-identifier">error</span> <span class="ruby-node">&quot;Rye::Hop: Disconnect timeout (#{ex.message})&quot;</span>&#x000A;338:         <span class="ruby-identifier">debug</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">backtrace</span>&#x000A;339:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Interrupt</span>&#x000A;340:         <span class="ruby-identifier">debug</span> <span class="ruby-value str">&quot;Exiting...&quot;</span>&#x000A;341:       <span class="ruby-keyword kw">end</span>&#x000A;342:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000209'>
                <a name='M000209'>      </a>
                <div class='synopsis'>
                  <span class='name'>error?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000209-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000209-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 55</span>&#x000A;55:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_error</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000210'>
                <a name='M000210'>      </a>
                <div class='synopsis'>
                  <span class='name'>exception_hook=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='description'>
                  <p>
                  A Hash. The keys are exception classes, the values are Procs to execute
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000210-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000210-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 59</span>&#x000A;59:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exception_hook=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_exception_hook</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000213'>
                <a name='M000213'>      </a>
                <div class='synopsis'>
                  <span class='name'>fetch_port</span>
                  <span class='arguments'>(host, port = 22, localport = nil)</span>
                </div>
                <div class='description'>
                  <p>
                  instance method, that will setup a forward, and return the port used
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000213-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000213-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 181</span>&#x000A;181:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_port</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span> = <span class="ruby-value">22</span>, <span class="ruby-identifier">localport</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;182:       <span class="ruby-identifier">connect</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_ssh</span>&#x000A;183:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">localport</span>.<span class="ruby-identifier">nil?</span>&#x000A;184:         <span class="ruby-identifier">port_used</span> = <span class="ruby-identifier">next_port</span>&#x000A;185:       <span class="ruby-keyword kw">else</span>&#x000A;186:         <span class="ruby-identifier">port_used</span> = <span class="ruby-identifier">localport</span>&#x000A;187:       <span class="ruby-keyword kw">end</span>&#x000A;188:       <span class="ruby-comment cmt"># i would like to check if the port and host </span>&#x000A;189:       <span class="ruby-comment cmt"># are already an active_locals forward, but that </span>&#x000A;190:       <span class="ruby-comment cmt"># info does not get returned, and trusting the localport</span>&#x000A;191:       <span class="ruby-comment cmt"># is not enough information, so lets just set up a new one</span>&#x000A;192:       <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">port_used</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>)&#x000A;193:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">port_used</span>&#x000A;194:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000197'>
                <a name='M000197'>      </a>
                <div class='synopsis'>
                  <span class='name'>host</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000197-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000197-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 39</span>&#x000A;39:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">host</span>; <span class="ruby-ivar">@rye_host</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000204'>
                <a name='M000204'>      </a>
                <div class='synopsis'>
                  <span class='name'>host=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000204-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000204-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 48</span>&#x000A;48:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">host=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_host</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000227'>
                <a name='M000227'>      </a>
                <div class='synopsis'>
                  <span class='name'>host_key</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns the host SSH keys for this box
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000227-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000227-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 366</span>&#x000A;366:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">host_key</span>&#x000A;367:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;No host&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_host</span>&#x000A;368:       <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">remote_host_keys</span>(<span class="ruby-ivar">@rye_host</span>)&#x000A;369:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000207'>
                <a name='M000207'>      </a>
                <div class='synopsis'>
                  <span class='name'>info?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000207-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000207-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 53</span>&#x000A;53:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">info?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_info</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000225'>
                <a name='M000225'>      </a>
                <div class='synopsis'>
                  <span class='name'>inspect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000225-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000225-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 350</span>&#x000A;350:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>&#x000A;351:       <span class="ruby-value str">%q{#&lt;%s:%s name=%s cwd=%s umask=%s env=%s via=%s opts=%s keys=%s&gt;}</span> <span class="ruby-operator">%</span> &#x000A;352:       [<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">nickname</span>,&#x000A;353:        <span class="ruby-ivar">@rye_current_working_directory</span>, <span class="ruby-ivar">@rye_current_umask</span>,&#x000A;354:        (<span class="ruby-ivar">@rye_current_environment_variables</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>).<span class="ruby-identifier">inspect</span>,&#x000A;355:        (<span class="ruby-ivar">@rye_via</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>).<span class="ruby-identifier">inspect</span>,&#x000A;356:        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">inspect</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">inspect</span>]&#x000A;357:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000223'>
                <a name='M000223'>      </a>
                <div class='synopsis'>
                  <span class='name'>keys</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  See <a href="../Rye.html#M000007">Rye.keys</a>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000223-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000223-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 345</span>&#x000A;345:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">keys</span>; <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000201'>
                <a name='M000201'>      </a>
                <div class='synopsis'>
                  <span class='name'>nickname</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000201-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000201-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 44</span>&#x000A;44:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nickname</span>; <span class="ruby-ivar">@rye_nickname</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">host</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000203'>
                <a name='M000203'>      </a>
                <div class='synopsis'>
                  <span class='name'>nickname=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000203-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000203-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 47</span>&#x000A;47:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nickname=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_nickname</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000198'>
                <a name='M000198'>      </a>
                <div class='synopsis'>
                  <span class='name'>opts</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000198-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000198-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 40</span>&#x000A;40:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">opts</span>; <span class="ruby-ivar">@rye_opts</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000205'>
                <a name='M000205'>      </a>
                <div class='synopsis'>
                  <span class='name'>opts=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000205-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000205-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 49</span>&#x000A;49:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">opts=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_opts</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000221'>
                <a name='M000221'>      </a>
                <div class='synopsis'>
                  <span class='name'>remove_hops!</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Cancel the port forward on all active local forwards
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000221-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000221-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 302</span>&#x000A;302:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_hops!</span>&#x000A;303:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>&#x000A;304:       <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">fport</span>, <span class="ruby-identifier">fhost</span><span class="ruby-operator">|</span> &#x000A;305:         <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">cancel_local</span>(<span class="ruby-identifier">fport</span>, <span class="ruby-identifier">fhost</span>)&#x000A;306:       }&#x000A;307:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-identifier">empty?</span>&#x000A;308:         <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">channel</span><span class="ruby-operator">|</span>&#x000A;309:           <span class="ruby-identifier">channel</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">close</span>&#x000A;310:         }&#x000A;311:       <span class="ruby-keyword kw">end</span>&#x000A;312:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">count</span>&#x000A;313:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000218'>
                <a name='M000218'>      </a>
                <div class='synopsis'>
                  <span class='name'>remove_key</span>
                  <span class='arguments'>(*keys)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="Hop.html#M000217">remove_keys</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000217'>
                <a name='M000217'>      </a>
                <div class='synopsis'>
                  <span class='name'>remove_keys</span>
                  <span class='arguments'>(*keys)</span>
                </div>
                <div class='description'>
                  <p>
                  Remove one or more private keys fromt he list of key paths.
                  </p>
                  <ul>
                  <li><tt>keys</tt> is a list of file paths to private keys
                  
                  </li>
                  </ul>
                  <p>
                  Returns the instance of <a href="Box.html">Box</a>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000217-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000217-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 215</span>&#x000A;215:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_keys</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">keys</span>)&#x000A;216:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>] <span class="ruby-operator">||=</span> []&#x000A;217:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>] <span class="ruby-operator">-=</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;218:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>].<span class="ruby-identifier">uniq!</span>&#x000A;219:       <span class="ruby-keyword kw">self</span> <span class="ruby-comment cmt"># MUST RETURN self</span>&#x000A;220:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000200'>
                <a name='M000200'>      </a>
                <div class='synopsis'>
                  <span class='name'>root?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000200-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000200-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 42</span>&#x000A;42:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">root?</span>; <span class="ruby-identifier">user</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;root&quot;</span> <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000214'>
                <a name='M000214'>      </a>
                <div class='synopsis'>
                  <span class='name'>ssh_config_options</span>
                  <span class='arguments'>(host)</span>
                </div>
                <div class='description'>
                  <p>
                  Parse SSH config files for use with Net::SSH
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000214-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000214-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 197</span>&#x000A;197:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ssh_config_options</span>(<span class="ruby-identifier">host</span>)&#x000A;198:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Config</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">host</span>)&#x000A;199:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000219'>
                <a name='M000219'>      </a>
                <div class='synopsis'>
                  <span class='name'>switch_user</span>
                  <span class='arguments'>(newuser)</span>
                </div>
                <div class='description'>
                  <p>
                  Reconnect as another user. This is different from su= which executes
                  subsequent commands via +su -c COMMAND USER+.
                  </p>
                  <ul>
                  <li><tt>newuser</tt> The username to reconnect as
                  
                  </li>
                  </ul>
                  <p>
                  NOTE: if there is an open connection, it&#8217;s disconnected but not
                  reconnected because it&#8217;s possible it wasn&#8217;t connected yet in
                  the first place (if you create the instance with default settings for
                  example)
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000219-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000219-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 231</span>&#x000A;231:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">switch_user</span>(<span class="ruby-identifier">newuser</span>)&#x000A;232:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">newuser</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">to_s</span>&#x000A;233:       <span class="ruby-ivar">@rye_opts</span> <span class="ruby-operator">||=</span> {}&#x000A;234:       <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">newuser</span>&#x000A;235:       <span class="ruby-identifier">disconnect</span>&#x000A;236:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000224'>
                <a name='M000224'>      </a>
                <div class='synopsis'>
                  <span class='name'>to_s</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns +user@rye_host+
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000224-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000224-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 348</span>&#x000A;348:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>; <span class="ruby-value str">'%s@rye_%s'</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">user</span>, <span class="ruby-ivar">@rye_host</span>]; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000199'>
                <a name='M000199'>      </a>
                <div class='synopsis'>
                  <span class='name'>user</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000199-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000199-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 41</span>&#x000A;41:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">user</span>; <span class="ruby-ivar">@rye_user</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000202'>
                <a name='M000202'>      </a>
                <div class='synopsis'>
                  <span class='name'>via</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000202-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000202-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 45</span>&#x000A;45:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">via</span>; <span class="ruby-ivar">@rye_via</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000206'>
                <a name='M000206'>      </a>
                <div class='synopsis'>
                  <span class='name'>via?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000206-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000206-source'>    <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 52</span>&#x000A;52:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">via?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000212'>
                <a name='M000212'>      </a>
                <div class='synopsis'>
                  <span class='name'>via_hop</span>
                  <span class='arguments'>(*hops)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>hops</tt> <a href="Hop.html">Rye::Hop</a> objects will be added
                  directly
                  
                  </li>
                  </ul>
                  <p>
                  to the set. Hostnames will be used to create new instances of <a
                  href="Hop.html">Rye::Hop</a> h1 = <a
                  href="Hop.html#M000211">Rye::Hop.new</a> &#8220;host1&#8221; h1.via_hop
                  &#8220;host2&#8221;, :user => &#8220;service_user&#8220;
                  </p>
                  <p>
                  OR
                  </p>
                  <p>
                  h1 = <a href="Hop.html#M000211">Rye::Hop.new</a> &#8220;host1&#8221; h2 =
                  <a href="Hop.html#M000211">Rye::Hop.new</a> &#8220;host2&#8221; h1.via_hop
                  h2
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000212-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000212-source'>     <span class="ruby-comment cmt"># File lib/rye/hop.rb, line 161</span>&#x000A;161:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">via_hop</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">hops</span>)&#x000A;162:       <span class="ruby-identifier">hops</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span> &#x000A;163:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">nil?</span>&#x000A;164:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@rye_via</span>&#x000A;165:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>)&#x000A;166:         <span class="ruby-ivar">@rye_via</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>&#x000A;167:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)&#x000A;168:         <span class="ruby-identifier">hop</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">shift</span>&#x000A;169:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;170:           <span class="ruby-ivar">@rye_via</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hop</span>, <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>)&#x000A;171:         <span class="ruby-keyword kw">else</span>&#x000A;172:           <span class="ruby-ivar">@rye_via</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hop</span>)&#x000A;173:         <span class="ruby-keyword kw">end</span>&#x000A;174:       <span class="ruby-keyword kw">end</span>&#x000A;175:       <span class="ruby-identifier">disconnect</span>&#x000A;176:       <span class="ruby-keyword kw">self</span>&#x000A;177:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
