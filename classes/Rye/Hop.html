<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Rye::Hop</title>
    <meta content='text/html; charset=US-ASCII' http-equiv='Content-Type'>
    <link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>class</span>
          Rye::Hop
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../files/lib/rye/hop_rb.html">lib/rye/hop.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../Rye.html">Rye</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <h1 id="label-Rye%3A%3AHop"><a href="Hop.html">Rye::Hop</a></h1>
            
            <p>The <a href="Hop.html">Rye::Hop</a> class represents a machine.  This class
            allows boxes to by accessed via it.</p>
            
            <pre class="ruby"><span class="ruby-identifier">rhop</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'firewall.lan'</span>)&#x000A;<span class="ruby-identifier">rbox</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Box</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'filibuster'</span>, :<span class="ruby-identifier">via</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rhop</span>)&#x000A;<span class="ruby-identifier">rbox</span>.<span class="ruby-identifier">uptime</span>     <span class="ruby-comment"># =&gt; 20:53  up 1 day,  1:52, 4 users</span></pre>
            
            <p>Or</p>
            
            <pre class="ruby"><span class="ruby-identifier">rbox</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Box</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'filibuster'</span>, :<span class="ruby-identifier">via</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'firewall.lan'</span>)</pre>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a target="docwin" href="#method-c-new">new</a></li>
            </ol>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-3D-3D">==</a></li>
              <li><a target="docwin" href="#method-i-add_keys">add_keys</a></li>
              <li><a target="docwin" href="#method-i-connect">connect</a></li>
              <li><a target="docwin" href="#method-i-debug-3F">debug?</a></li>
              <li><a target="docwin" href="#method-i-disconnect">disconnect</a></li>
              <li><a target="docwin" href="#method-i-error-3F">error?</a></li>
              <li><a target="docwin" href="#method-i-exception_hook-3D">exception_hook=</a></li>
              <li><a target="docwin" href="#method-i-fetch_port">fetch_port</a></li>
              <li><a target="docwin" href="#method-i-host">host</a></li>
              <li><a target="docwin" href="#method-i-host-3D">host=</a></li>
              <li><a target="docwin" href="#method-i-host_key">host_key</a></li>
              <li><a target="docwin" href="#method-i-info-3F">info?</a></li>
              <li><a target="docwin" href="#method-i-inspect">inspect</a></li>
              <li><a target="docwin" href="#method-i-keys">keys</a></li>
              <li><a target="docwin" href="#method-i-nickname">nickname</a></li>
              <li><a target="docwin" href="#method-i-nickname-3D">nickname=</a></li>
              <li><a target="docwin" href="#method-i-opts">opts</a></li>
              <li><a target="docwin" href="#method-i-opts-3D">opts=</a></li>
              <li><a target="docwin" href="#method-i-remove_hops-21">remove_hops!</a></li>
              <li><a target="docwin" href="#method-i-remove_keys">remove_keys</a></li>
              <li><a target="docwin" href="#method-i-root-3F">root?</a></li>
              <li><a target="docwin" href="#method-i-ssh_config_options">ssh_config_options</a></li>
              <li><a target="docwin" href="#method-i-switch_user">switch_user</a></li>
              <li><a target="docwin" href="#method-i-to_s">to_s</a></li>
              <li><a target="docwin" href="#method-i-user">user</a></li>
              <li><a target="docwin" href="#method-i-via">via</a></li>
              <li><a target="docwin" href="#method-i-via-3F">via?</a></li>
              <li><a target="docwin" href="#method-i-via_hop">via_hop</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>MAX_PORT</td>
                    <td>=</td>
                    <td class='context-item-value'>65535</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>The maximum port number that the gateway will attempt to use to forward
                      connections from.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>MIN_PORT</td>
                    <td>=</td>
                    <td class='context-item-value'>1024</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'>
                      
                      <p>The minimum port number that the gateway will attempt to use to forward
                      connections from.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='aliases-list'>
              <h2>Public Instance Aliases</h2>
              <div class='name-list'>
                <table summary='Public Instance Aliases'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>add_key</td>
                    <td>-&gt;</td>
                    <td class='context-item-value'><a target="docwin" href="#method-i-add_keys">add_keys</a></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>remove_key</td>
                    <td>-&gt;</td>
                    <td class='context-item-value'><a target="docwin" href="#method-i-remove_keys">remove_keys</a></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-new'>
                <a name='method-c-new'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(host, opts={})</span>
                </div>
                <div class='description'>
                  <ul><li>
                  <p><code>host</code> The hostname to connect to. Default: localhost.</p>
                  </li><li>
                  <p><code>user</code> The username to connect as. Default: SSH config file or
                  current shell user.</p>
                  </li><li>
                  <p><code>opts</code> a hash of optional arguments.</p>
                  </li></ul>
                  
                  <p>The <code>opts</code> hash excepts the following keys:</p>
                  <ul><li>
                  <p>:port =&gt; remote server ssh port. Default: SSH config file or 22</p>
                  </li><li>
                  <p>:keys =&gt; one or more private key file paths (passwordless login)</p>
                  </li><li>
                  <p>:via =&gt; the <a href="Hop.html">Rye::Hop</a> to access this host through</p>
                  </li><li>
                  <p>:info =&gt; an IO object to print <a href="Box.html">Rye::Box</a> command
                  info to. Default: nil</p>
                  </li><li>
                  <p>:debug =&gt; an IO object to print <a href="Box.html">Rye::Box</a>
                  debugging info to. Default: nil</p>
                  </li><li>
                  <p>:error =&gt; an IO object to print <a href="Box.html">Rye::Box</a> errors
                  to. Default: STDERR</p>
                  </li><li>
                  <p>:getenv =&gt; pre-fetch <code>host</code> environment variables? (default:
                  true)</p>
                  </li><li>
                  <p>:password =&gt; the user's password (ignored if there's a valid private
                  key)</p>
                  </li><li>
                  <p>:templates =&gt; the template engine to use for uploaded files. One of:
                  :erb (default)</p>
                  </li><li>
                  <p>:sudo =&gt; Run all commands via sudo (default: false)</p>
                  </li></ul>
                  
                  <p>NOTE: <code>opts</code> can also contain any parameter supported by 
                  Net::SSH.start that is not already mentioned above.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-new-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-new-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 81</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">opts</span>={})&#x000A;  <span class="ruby-identifier">ssh_opts</span> = <span class="ruby-identifier">ssh_config_options</span>(<span class="ruby-identifier">host</span>)&#x000A;  <span class="ruby-ivar">@rye_exception_hook</span> = {}&#x000A;  <span class="ruby-ivar">@rye_host</span> = <span class="ruby-identifier">host</span>&#x000A;  &#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:user</span>]&#x000A;    <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:user</span>]&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">ssh_opts</span>[<span class="ruby-value">:user</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>.<span class="ruby-identifier">user</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  &#x000A;  <span class="ruby-comment"># These opts are use by Rye::Box and also passed to</span>&#x000A;  <span class="ruby-comment"># Net::SSH::Gateway (and Net::SSH)</span>&#x000A;  <span class="ruby-ivar">@rye_opts</span> = {&#x000A;    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ssh_opts</span>[<span class="ruby-value">:port</span>],&#x000A;    <span class="ruby-value">:keys</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>,&#x000A;    <span class="ruby-value">:via</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,&#x000A;    <span class="ruby-value">:info</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,&#x000A;    <span class="ruby-value">:debug</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,&#x000A;    <span class="ruby-value">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">STDERR</span>,&#x000A;    <span class="ruby-value">:getenv</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>,&#x000A;    <span class="ruby-value">:templates</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:erb</span>,&#x000A;    <span class="ruby-value">:quiet</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>&#x000A;  }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)&#x000A;&#x000A;  <span class="ruby-ivar">@next_port</span> = <span class="ruby-constant">MAX_PORT</span>&#x000A;&#x000A;  <span class="ruby-comment"># Close the SSH session before Ruby exits. This will do nothing</span>&#x000A;  <span class="ruby-comment"># if disconnect has already been called explicitly. </span>&#x000A;  <span class="ruby-identifier">at_exit</span> { <span class="ruby-keyword">self</span>.<span class="ruby-identifier">disconnect</span> }&#x000A;&#x000A;  <span class="ruby-comment"># Properly handle whether the opt :via is a +Rye::Hop+ or a +String+</span>&#x000A;  <span class="ruby-comment"># and does nothing if nil</span>&#x000A;  <span class="ruby-identifier">via_hop</span>(<span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:via</span>))&#x000A;&#x000A;  <span class="ruby-comment"># @rye_opts gets sent to Net::SSH so we need to remove the keys</span>&#x000A;  <span class="ruby-comment"># that are not meant for it. </span>&#x000A;  <span class="ruby-ivar">@rye_safe</span>, <span class="ruby-ivar">@rye_debug</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:safe</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:debug</span>)&#x000A;  <span class="ruby-ivar">@rye_info</span>, <span class="ruby-ivar">@rye_error</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:info</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:error</span>)&#x000A;  <span class="ruby-ivar">@rye_getenv</span> = {} <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:getenv</span>) <span class="ruby-comment"># Enable getenv with a hash</span>&#x000A;  <span class="ruby-ivar">@rye_ostype</span>, <span class="ruby-ivar">@rye_impltype</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:ostype</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:impltype</span>)&#x000A;  <span class="ruby-ivar">@rye_quiet</span>, <span class="ruby-ivar">@rye_sudo</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:quiet</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:sudo</span>)&#x000A;  <span class="ruby-ivar">@rye_templates</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:templates</span>)&#x000A;  &#x000A;  <span class="ruby-comment"># Store the state of the terminal </span>&#x000A;  <span class="ruby-ivar">@rye_stty_save</span> = <span class="ruby-value">%xstty -g`</span>.<span class="ruby-identifier">chomp</span> <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>&#x000A;  &#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_templates</span>.<span class="ruby-identifier">nil?</span>&#x000A;    <span class="ruby-identifier">require</span> <span class="ruby-ivar">@rye_templates</span>.<span class="ruby-identifier">to_s</span>   <span class="ruby-comment"># should be :erb</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  &#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:logger</span>] = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@rye_debug</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_debug</span> <span class="ruby-comment"># Enable Net::SSH debugging</span>&#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] = [<span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>]].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;  &#x000A;  <span class="ruby-comment"># Just in case someone sends a true value rather than IO object</span>&#x000A;  <span class="ruby-ivar">@rye_debug</span> = <span class="ruby-constant">STDERR</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_debug</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">||</span> <span class="ruby-constant">DEBUG</span>&#x000A;  <span class="ruby-ivar">@rye_error</span> = <span class="ruby-constant">STDERR</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_error</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-ivar">@rye_info</span> = <span class="ruby-constant">STDOUT</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>&#x000A;  &#x000A;  <span class="ruby-comment"># Add the given private keys to the keychain that will be used for @rye_host</span>&#x000A;  <span class="ruby-identifier">add_keys</span>(<span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>])&#x000A;  &#x000A;  <span class="ruby-comment"># From: capistrano/lib/capistrano/cli.rb</span>&#x000A;  <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span> <span class="ruby-comment"># so that Net::SSH prompts show up</span>&#x000A;  &#x000A;  <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ssh-agent info: #{Rye.sshagent_info.inspect}&quot;</span>&#x000A;  <span class="ruby-identifier">debug</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">inspect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-3D-3D'>
                <a name='method-i-3D-3D'></a>
                <div class='synopsis'>
                  <span class='name'>==</span>
                  <span class='arguments'>(other)</span>
                </div>
                <div class='description'>
                  
                  <p>Compares itself with the <code>other</code> box. If the hostnames are the
                  same, this will return true. Otherwise false.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-3D-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-3D-3D-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 361</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)&#x000A;  <span class="ruby-ivar">@rye_host</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">host</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-add_keys'>
                <a name='method-i-add_keys'></a>
                <div class='synopsis'>
                  <span class='name'>add_keys</span>
                  <span class='arguments'>(*keys)</span>
                </div>
                <div class='description'>
                  
                  <p>Add one or more private keys to the list of key paths.</p>
                  <ul><li>
                  <p><code>keys</code> is a list of file paths to private keys</p>
                  </li></ul>
                  
                  <p>Returns the instance of <a href="Box.html">Box</a></p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-add_keys-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-add_keys-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 204</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_keys</span>(*<span class="ruby-identifier">keys</span>)&#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] <span class="ruby-operator">||=</span> []&#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>].<span class="ruby-identifier">uniq!</span>&#x000A;  <span class="ruby-keyword">self</span> <span class="ruby-comment"># MUST RETURN self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-connect'>
                <a name='method-i-connect'></a>
                <div class='synopsis'>
                  <span class='name'>connect</span>
                  <span class='arguments'>(reconnect=true)</span>
                </div>
                <div class='description'>
                  
                  <p>Open an SSH session with +@rye_host+. This called automatically when you
                  the first comamnd is run if it's not already connected. Raises a <a
                  href="NoHost.html">Rye::NoHost</a> exception if +@rye_host+ is not
                  specified. Will attempt a password login up to 3 times if the initial 
                  authentication fails.</p>
                  <ul><li>
                  <p><code>reconnect</code> Disconnect first if already connected. The default</p>
                  </li></ul>
                  
                  <p>is true. When set to false, connect will do nothing if already  connected.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-connect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-connect-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 246</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">connect</span>(<span class="ruby-identifier">reconnect</span>=<span class="ruby-keyword">true</span>)&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">NoHost</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_host</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reconnect</span>&#x000A;  <span class="ruby-identifier">disconnect</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_ssh</span> &#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_via</span>&#x000A;    <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Opening connection to #{@rye_host} as #{@rye_user}, via #{@rye_via.host}&quot;</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Opening connection to #{@rye_host} as #{@rye_user}&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">highline</span> = <span class="ruby-constant">HighLine</span>.<span class="ruby-identifier">new</span> <span class="ruby-comment"># Used for password prompt</span>&#x000A;  <span class="ruby-identifier">retried</span> = <span class="ruby-value">0</span>&#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>].<span class="ruby-identifier">compact!</span>  <span class="ruby-comment"># A quick fix in Windows. TODO: Why is there a nil?</span>&#x000A;  <span class="ruby-keyword">begin</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_via</span>&#x000A;      <span class="ruby-comment"># tell the +Rye::Hop+ what and where to setup,</span>&#x000A;      <span class="ruby-comment"># it returns the local port used</span>&#x000A;      <span class="ruby-ivar">@rye_localport</span> = <span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">fetch_port</span>(<span class="ruby-ivar">@rye_host</span>, <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:port</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-value">22</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:port</span>] )&#x000A;      <span class="ruby-ivar">@rye_ssh</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span>.<span class="ruby-identifier">start</span>(<span class="ruby-string">&quot;localhost&quot;</span>, <span class="ruby-ivar">@rye_user</span>, <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@rye_localport</span>) <span class="ruby-operator">||</span> {}) &#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-ivar">@rye_ssh</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span>.<span class="ruby-identifier">start</span>(<span class="ruby-ivar">@rye_host</span>, <span class="ruby-ivar">@rye_user</span>, <span class="ruby-ivar">@rye_opts</span> <span class="ruby-operator">||</span> {}) &#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">debug</span> <span class="ruby-string">&quot;starting the port forward thread&quot;</span>&#x000A;    <span class="ruby-identifier">port_loop</span>&#x000A;  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">HostKeyMismatch</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">message</span>&#x000A;    <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;\a&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-comment"># Ring the bell</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">highline</span>.<span class="ruby-identifier">ask</span>(<span class="ruby-string">&quot;Continue? &quot;</span>).<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">%r\Ay|yes|sure|ya\z/</span>)&#x000A;      <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:paranoid</span>] = <span class="ruby-keyword">false</span>&#x000A;      <span class="ruby-keyword">retry</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">HostKeyMismatch</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">AuthenticationFailed</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;    <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;\a&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">retried</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-comment"># Ring the bell once</span>&#x000A;    <span class="ruby-identifier">retried</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-constant">STDIN</span>.<span class="ruby-identifier">tty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">retried</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>&#x000A;      <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Passwordless login failed for #{@rye_user}&quot;</span>&#x000A;      <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:password</span>] = <span class="ruby-identifier">highline</span>.<span class="ruby-identifier">ask</span>(<span class="ruby-string">&quot;Password: &quot;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">echo</span> = <span class="ruby-string">''</span> }.<span class="ruby-identifier">strip</span>&#x000A;      <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:auth_methods</span>] <span class="ruby-operator">||=</span> []&#x000A;      <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:auth_methods</span>].<span class="ruby-identifier">push</span> *[<span class="ruby-string">'keyboard-interactive'</span>, <span class="ruby-string">'password'</span>]&#x000A;      <span class="ruby-keyword">retry</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">AuthenticationFailed</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  &#x000A;  <span class="ruby-comment"># We add :auth_methods (a Net::SSH joint) to force asking for a</span>&#x000A;  <span class="ruby-comment"># password if the initial (key-based) authentication fails. We</span>&#x000A;  <span class="ruby-comment"># need to delete the key from @rye_opts otherwise it lingers until</span>&#x000A;  <span class="ruby-comment"># the next connection (if we switch_user is called for example).</span>&#x000A;  <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value">:auth_methods</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:auth_methods</span>)&#x000A;  &#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-debug-3F'>
                <a name='method-i-debug-3F'></a>
                <div class='synopsis'>
                  <span class='name'>debug?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-debug-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-debug-3F-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 54</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">debug?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_debug</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-disconnect'>
                <a name='method-i-disconnect'></a>
                <div class='synopsis'>
                  <span class='name'>disconnect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Close the SSH session  with +@rye_host+. This is called  automatically at
                  exit if the connection is open.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-disconnect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-disconnect-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 317</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">disconnect</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">closed?</span>&#x000A;  <span class="ruby-keyword">begin</span>&#x000A;    <span class="ruby-identifier">debug</span> <span class="ruby-string">&quot;removing active forwards&quot;</span>&#x000A;    <span class="ruby-identifier">remove_hops!</span>&#x000A;    <span class="ruby-identifier">debug</span> <span class="ruby-string">&quot;killing port_loop @rye_port_thread&quot;</span>&#x000A;    <span class="ruby-ivar">@rye_port_thread</span>.<span class="ruby-identifier">kill</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">busy?</span>;&#x000A;      <span class="ruby-identifier">info</span> <span class="ruby-string">&quot;Is something still running? (ctrl-C to exit)&quot;</span>&#x000A;      <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-identifier">timeout</span>(<span class="ruby-value">10</span>) <span class="ruby-keyword">do</span>&#x000A;        <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">loop</span>(<span class="ruby-value">0.3</span>) { <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">busy?</span>; }&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Closing connection to #{@rye_ssh.host}&quot;</span>&#x000A;    <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">close</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_via</span>&#x000A;      <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;disconnecting Hop #{@rye_via.host}&quot;</span>&#x000A;      <span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">disconnect</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;    <span class="ruby-identifier">error</span> <span class="ruby-node">&quot;Rye::Hop: Disconnect timeout (#{ex.message})&quot;</span>&#x000A;    <span class="ruby-identifier">debug</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">backtrace</span>&#x000A;  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Interrupt</span>&#x000A;    <span class="ruby-identifier">debug</span> <span class="ruby-string">&quot;Exiting...&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-error-3F'>
                <a name='method-i-error-3F'></a>
                <div class='synopsis'>
                  <span class='name'>error?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-error-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-error-3F-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 55</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">error?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_error</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-exception_hook-3D'>
                <a name='method-i-exception_hook-3D'></a>
                <div class='synopsis'>
                  <span class='name'>exception_hook=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='description'>
                  
                  <p>A Hash. The keys are exception classes, the values are Procs to execute</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-exception_hook-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-exception_hook-3D-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 59</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">exception_hook=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_exception_hook</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-fetch_port'>
                <a name='method-i-fetch_port'></a>
                <div class='synopsis'>
                  <span class='name'>fetch_port</span>
                  <span class='arguments'>(host, port = 22, localport = nil)</span>
                </div>
                <div class='description'>
                  
                  <p>instance method, that will setup a forward, and return the port used</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-fetch_port-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-fetch_port-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 181</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">fetch_port</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span> = <span class="ruby-value">22</span>, <span class="ruby-identifier">localport</span> = <span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-identifier">connect</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_ssh</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">localport</span>.<span class="ruby-identifier">nil?</span>&#x000A;    <span class="ruby-identifier">port_used</span> = <span class="ruby-identifier">next_port</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">port_used</span> = <span class="ruby-identifier">localport</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-comment"># i would like to check if the port and host </span>&#x000A;  <span class="ruby-comment"># are already an active_locals forward, but that </span>&#x000A;  <span class="ruby-comment"># info does not get returned, and trusting the localport</span>&#x000A;  <span class="ruby-comment"># is not enough information, so lets just set up a new one</span>&#x000A;  <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">port_used</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-identifier">port_used</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-host'>
                <a name='method-i-host'></a>
                <div class='synopsis'>
                  <span class='name'>host</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-host-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-host-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 39</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">host</span>; <span class="ruby-ivar">@rye_host</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-host-3D'>
                <a name='method-i-host-3D'></a>
                <div class='synopsis'>
                  <span class='name'>host=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-host-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-host-3D-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 48</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">host=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_host</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-host_key'>
                <a name='method-i-host_key'></a>
                <div class='synopsis'>
                  <span class='name'>host_key</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns the host SSH keys for this box</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-host_key-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-host_key-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 366</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">host_key</span>&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;No host&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_host</span>&#x000A;  <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">remote_host_keys</span>(<span class="ruby-ivar">@rye_host</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-info-3F'>
                <a name='method-i-info-3F'></a>
                <div class='synopsis'>
                  <span class='name'>info?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-info-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-info-3F-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 53</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">info?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_info</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-inspect'>
                <a name='method-i-inspect'></a>
                <div class='synopsis'>
                  <span class='name'>inspect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-inspect-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-inspect-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 350</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>&#x000A;  <span class="ruby-string">%q{#&lt;%s:%s name=%s cwd=%s umask=%s env=%s via=%s opts=%s keys=%s&gt;}</span> <span class="ruby-operator">%</span> &#x000A;  [<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nickname</span>,&#x000A;   <span class="ruby-ivar">@rye_current_working_directory</span>, <span class="ruby-ivar">@rye_current_umask</span>,&#x000A;   (<span class="ruby-ivar">@rye_current_environment_variables</span> <span class="ruby-operator">||</span> <span class="ruby-string">''</span>).<span class="ruby-identifier">inspect</span>,&#x000A;   (<span class="ruby-ivar">@rye_via</span> <span class="ruby-operator">||</span> <span class="ruby-string">''</span>).<span class="ruby-identifier">inspect</span>,&#x000A;   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">inspect</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">inspect</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-keys'>
                <a name='method-i-keys'></a>
                <div class='synopsis'>
                  <span class='name'>keys</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>See <a href="../Rye.html#method-i-keys">Rye#keys</a></p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-keys-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-keys-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 345</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">keys</span>; <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-nickname'>
                <a name='method-i-nickname'></a>
                <div class='synopsis'>
                  <span class='name'>nickname</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-nickname-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-nickname-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 44</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">nickname</span>; <span class="ruby-ivar">@rye_nickname</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">host</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-nickname-3D'>
                <a name='method-i-nickname-3D'></a>
                <div class='synopsis'>
                  <span class='name'>nickname=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-nickname-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-nickname-3D-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 47</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">nickname=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_nickname</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-opts'>
                <a name='method-i-opts'></a>
                <div class='synopsis'>
                  <span class='name'>opts</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-opts-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-opts-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 40</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">opts</span>; <span class="ruby-ivar">@rye_opts</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-opts-3D'>
                <a name='method-i-opts-3D'></a>
                <div class='synopsis'>
                  <span class='name'>opts=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-opts-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-opts-3D-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 49</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">opts=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_opts</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-remove_hops-21'>
                <a name='method-i-remove_hops-21'></a>
                <div class='synopsis'>
                  <span class='name'>remove_hops!</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Cancel the port forward on all active local forwards</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-remove_hops-21-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-remove_hops-21-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 302</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_hops!</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>&#x000A;  <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">fport</span>, <span class="ruby-identifier">fhost</span><span class="ruby-operator">|</span> &#x000A;    <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">cancel_local</span>(<span class="ruby-identifier">fport</span>, <span class="ruby-identifier">fhost</span>)&#x000A;  }&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-identifier">empty?</span>&#x000A;    <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">channel</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">channel</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">close</span>&#x000A;    }&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">count</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-remove_keys'>
                <a name='method-i-remove_keys'></a>
                <div class='synopsis'>
                  <span class='name'>remove_keys</span>
                  <span class='arguments'>(*keys)</span>
                </div>
                <div class='description'>
                  
                  <p>Remove one or more private keys fromt he list of key paths.</p>
                  <ul><li>
                  <p><code>keys</code> is a list of file paths to private keys</p>
                  </li></ul>
                  
                  <p>Returns the instance of <a href="Box.html">Box</a></p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-remove_keys-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-remove_keys-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 215</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_keys</span>(*<span class="ruby-identifier">keys</span>)&#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] <span class="ruby-operator">||=</span> []&#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] <span class="ruby-operator">-=</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>].<span class="ruby-identifier">uniq!</span>&#x000A;  <span class="ruby-keyword">self</span> <span class="ruby-comment"># MUST RETURN self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-root-3F'>
                <a name='method-i-root-3F'></a>
                <div class='synopsis'>
                  <span class='name'>root?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-root-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-root-3F-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 42</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">root?</span>; <span class="ruby-identifier">user</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;root&quot;</span> <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-ssh_config_options'>
                <a name='method-i-ssh_config_options'></a>
                <div class='synopsis'>
                  <span class='name'>ssh_config_options</span>
                  <span class='arguments'>(host)</span>
                </div>
                <div class='description'>
                  
                  <p>Parse SSH config files for use with Net::SSH</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-ssh_config_options-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-ssh_config_options-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 197</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">ssh_config_options</span>(<span class="ruby-identifier">host</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Config</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">host</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-switch_user'>
                <a name='method-i-switch_user'></a>
                <div class='synopsis'>
                  <span class='name'>switch_user</span>
                  <span class='arguments'>(newuser)</span>
                </div>
                <div class='description'>
                  
                  <p>Reconnect as another user. This is different from su= which executes
                  subsequent commands via +su -c COMMAND USER+.</p>
                  <ul><li>
                  <p><code>newuser</code> The username to reconnect as</p>
                  </li></ul>
                  
                  <p>NOTE: if there is an open connection, it's disconnected but not reconnected
                  because it's possible it wasn't  connected yet in the first place (if you
                  create the  instance with default settings for example)</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-switch_user-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-switch_user-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 231</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">switch_user</span>(<span class="ruby-identifier">newuser</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">newuser</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-ivar">@rye_opts</span> <span class="ruby-operator">||=</span> {}&#x000A;  <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">newuser</span>&#x000A;  <span class="ruby-identifier">disconnect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-to_s'>
                <a name='method-i-to_s'></a>
                <div class='synopsis'>
                  <span class='name'>to_s</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns +user@rye_host+</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-to_s-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-to_s-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 348</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>; <span class="ruby-string">'%s@rye_%s'</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">user</span>, <span class="ruby-ivar">@rye_host</span>]; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-user'>
                <a name='method-i-user'></a>
                <div class='synopsis'>
                  <span class='name'>user</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-user-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-user-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 41</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">user</span>; <span class="ruby-ivar">@rye_user</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-via'>
                <a name='method-i-via'></a>
                <div class='synopsis'>
                  <span class='name'>via</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-via-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-via-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 45</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">via</span>; <span class="ruby-ivar">@rye_via</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-via-3F'>
                <a name='method-i-via-3F'></a>
                <div class='synopsis'>
                  <span class='name'>via?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-via-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-via-3F-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 52</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">via?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-via_hop'>
                <a name='method-i-via_hop'></a>
                <div class='synopsis'>
                  <span class='name'>via_hop</span>
                  <span class='arguments'>(*hops)</span>
                </div>
                <div class='description'>
                  <ul><li>
                  <p><code>hops</code> <a href="Hop.html">Rye::Hop</a> objects will be added
                  directly</p>
                  </li></ul>
                  
                  <p>to the set. Hostnames will be used to create new instances of <a
                  href="Hop.html">Rye::Hop</a>  h1 = <a
                  href="Hop.html#method-c-new">::new</a> "host1" h1.via_hop "host2", :user
                  =&gt; "service_user"</p>
                  
                  <p>OR</p>
                  
                  <p>h1 = <a href="Hop.html#method-c-new">::new</a> "host1" h2 = <a
                  href="Hop.html#method-c-new">::new</a> "host2" h1.via_hop h2</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-via_hop-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-via_hop-source'><span class="ruby-comment"># File lib/rye/hop.rb, line 161</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">via_hop</span>(*<span class="ruby-identifier">hops</span>)&#x000A;  <span class="ruby-identifier">hops</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span> &#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">nil?</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-ivar">@rye_via</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>)&#x000A;    <span class="ruby-ivar">@rye_via</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)&#x000A;    <span class="ruby-identifier">hop</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">shift</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;      <span class="ruby-ivar">@rye_via</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hop</span>, <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>)&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-ivar">@rye_via</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hop</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">disconnect</span>&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
