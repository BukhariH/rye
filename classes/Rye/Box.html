<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Rye::Box [Rye: Safely run SSH commands on a bunch of machines at the same time (from Ruby).]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <div class='name'>
          <span class='type'>Class</span>
          Rye::Box
        </div>
        <ol class='paths'>
          <li>
            <a href="../../files/lib/rye/box_rb.html">lib/rye/box.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <h1><a href="Box.html">Rye::Box</a></h1>
            <p>
            The <a href="Box.html">Rye::Box</a> class represents a machine. All system
            commands are made through this class.
            </p>
            <pre>rbox = Rye::Box.new('filibuster')&#x000A;rbox.hostname   # =&gt; filibuster&#x000A;rbox.uname      # =&gt; FreeBSD&#x000A;rbox.uptime     # =&gt; 20:53  up 1 day,  1:52, 4 users</pre>
            <p>
            You can also run local commands through SSH
            </p>
            <pre>rbox = Rye::Box.new('localhost')&#x000A;rbox.hostname   # =&gt; localhost&#x000A;rbox.uname(:a)  # =&gt; Darwin vanya 9.6.0 ...</pre>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000134">new</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000151">==</a></li>
              <li><a href="#M000136">[]</a></li>
              <li><a href="#M000147">add_env</a></li>
              <li><a href="#M000142">add_key</a></li>
              <li><a href="#M000141">add_keys</a></li>
              <li><a href="#M000155">authorize_keys_local</a></li>
              <li><a href="#M000154">authorize_keys_remote</a></li>
              <li><a href="#M000161">batch</a></li>
              <li><a href="#M000137">cd</a></li>
              <li><a href="#M000167">connect</a></li>
              <li><a href="#M000125">current_umask</a></li>
              <li><a href="#M000124">current_working_directory</a></li>
              <li><a href="#M000127">debug</a></li>
              <li><a href="#M000123">disable_quiet_mode</a></li>
              <li><a href="#M000120">disable_safe_mode</a></li>
              <li><a href="#M000168">disconnect</a></li>
              <li><a href="#M000122">enable_quiet_mode</a></li>
              <li><a href="#M000119">enable_safe_mode</a></li>
              <li><a href="#M000128">error</a></li>
              <li><a href="#M000160">exception_hook</a></li>
              <li><a href="#M000133">exception_hook=</a></li>
              <li><a href="#M000157">execute</a></li>
              <li><a href="#M000145">getenv</a></li>
              <li><a href="#M000153">guess_user_home</a></li>
              <li><a href="#M000108">host</a></li>
              <li><a href="#M000115">host=</a></li>
              <li><a href="#M000152">host_key</a></li>
              <li><a href="#M000144">impltype</a></li>
              <li><a href="#M000130">impltype=</a></li>
              <li><a href="#M000126">info</a></li>
              <li><a href="#M000150">inspect</a></li>
              <li><a href="#M000165">instance_exec</a></li>
              <li><a href="#M000140">interactive_ssh</a></li>
              <li><a href="#M000148">keys</a></li>
              <li><a href="#M000156">method_missing</a></li>
              <li><a href="#M000114">nickname</a></li>
              <li><a href="#M000118">nickname=</a></li>
              <li><a href="#M000109">opts</a></li>
              <li><a href="#M000116">opts=</a></li>
              <li><a href="#M000143">ostype</a></li>
              <li><a href="#M000129">ostype=</a></li>
              <li><a href="#M000166">post_command_hook</a></li>
              <li><a href="#M000132">post_command_hook=</a></li>
              <li><a href="#M000159">pre_command_hook</a></li>
              <li><a href="#M000131">pre_command_hook=</a></li>
              <li><a href="#M000158">preview_command</a></li>
              <li><a href="#M000113">quiet</a></li>
              <li><a href="#M000164">quietly</a></li>
              <li><a href="#M000110">safe</a></li>
              <li><a href="#M000121">safe?</a></li>
              <li><a href="#M000163">safely</a></li>
              <li><a href="#M000146">setenv</a></li>
              <li><a href="#M000135">ssh_config_options</a></li>
              <li><a href="#M000112">stash</a></li>
              <li><a href="#M000117">stash=</a></li>
              <li><a href="#M000139">switch_user</a></li>
              <li><a href="#M000149">to_s</a></li>
              <li><a href="#M000138">umask=</a></li>
              <li><a href="#M000162">unsafely</a></li>
              <li><a href="#M000111">user</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li><a href="Cmd.html">Rye::Cmd</a></li>
                <li><a href="Box/InstanceExecHelper.html">InstanceExecHelper</a></li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Module <a href="Box/InstanceExecHelper.html" class="link">Rye::Box::InstanceExecHelper</a><br />
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='method public-class' id='method-M000134'>
                <a name='M000134'>      </a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(host='localhost', opts={})</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>host</tt> The hostname to connect to. Default: localhost.
                  
                  </li>
                  <li><tt>user</tt> The username to connect as. Default: SSH config file or
                  current shell user.
                  
                  </li>
                  <li><tt>opts</tt> a hash of optional arguments.
                  
                  </li>
                  </ul>
                  <p>
                  The <tt>opts</tt> hash excepts the following keys:
                  </p>
                  <ul>
                  <li>:safe => should <a href="../Rye.html">Rye</a> be safe? Default: true
                  
                  </li>
                  <li>:port => remote server ssh port. Default: SSH config file or 22
                  
                  </li>
                  <li>:keys => one or more private key file paths (passwordless login)
                  
                  </li>
                  <li>:info => an IO object to print <a href="Box.html">Rye::Box</a> command info
                  to. Default: nil
                  
                  </li>
                  <li>:debug => an IO object to print <a href="Box.html">Rye::Box</a> debugging
                  info to. Default: nil
                  
                  </li>
                  <li>:error => an IO object to print <a href="Box.html">Rye::Box</a> errors to.
                  Default: STDERR
                  
                  </li>
                  <li>:getenv => pre-fetch <tt>host</tt> environment variables? (default: true)
                  
                  </li>
                  <li>:password => the user&#8217;s password (ignored if there&#8217;s a valid
                  private key)
                  
                  </li>
                  </ul>
                  <p>
                  NOTE: <tt>opts</tt> can also contain any parameter supported by
                  Net::SSH.start that is not already mentioned above.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000134-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000134-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 91</span>&#x000A; 91:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">host</span>=<span class="ruby-value str">'localhost'</span>, <span class="ruby-identifier">opts</span>={})&#x000A; 92:       <span class="ruby-identifier">ssh_opts</span> = <span class="ruby-identifier">ssh_config_options</span>(<span class="ruby-identifier">host</span>)&#x000A; 93:       <span class="ruby-ivar">@rye_exception_hook</span> = {}&#x000A; 94:       <span class="ruby-ivar">@rye_host</span> = <span class="ruby-identifier">host</span>&#x000A; 95:       &#x000A; 96:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:user</span>]&#x000A; 97:         <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:user</span>]&#x000A; 98:       <span class="ruby-keyword kw">else</span>&#x000A; 99:         <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">ssh_opts</span>[<span class="ruby-identifier">:user</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>.<span class="ruby-identifier">user</span>&#x000A;100:       <span class="ruby-keyword kw">end</span>&#x000A;101: &#x000A;102:       <span class="ruby-comment cmt"># These opts are use by Rye::Box and also passed to Net::SSH</span>&#x000A;103:       <span class="ruby-ivar">@rye_opts</span> = {&#x000A;104:         <span class="ruby-identifier">:safe</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,&#x000A;105:         <span class="ruby-identifier">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ssh_opts</span>[<span class="ruby-identifier">:port</span>],&#x000A;106:         <span class="ruby-identifier">:keys</span> =<span class="ruby-operator">&gt;</span> [],&#x000A;107:         <span class="ruby-identifier">:info</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,&#x000A;108:         <span class="ruby-identifier">:debug</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,&#x000A;109:         <span class="ruby-identifier">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">STDERR</span>,&#x000A;110:         <span class="ruby-identifier">:getenv</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,&#x000A;111:         <span class="ruby-identifier">:quiet</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>&#x000A;112:       }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)&#x000A;113:       &#x000A;114:       <span class="ruby-comment cmt"># Close the SSH session before Ruby exits. This will do nothing</span>&#x000A;115:       <span class="ruby-comment cmt"># if disconnect has already been called explicitly. </span>&#x000A;116:       <span class="ruby-identifier">at_exit</span> { <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">disconnect</span> }&#x000A;117:       &#x000A;118:       <span class="ruby-comment cmt"># @rye_opts gets sent to Net::SSH so we need to remove the keys</span>&#x000A;119:       <span class="ruby-comment cmt"># that are not meant for it. </span>&#x000A;120:       <span class="ruby-ivar">@rye_safe</span>, <span class="ruby-ivar">@rye_debug</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:safe</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:debug</span>)&#x000A;121:       <span class="ruby-ivar">@rye_info</span>, <span class="ruby-ivar">@rye_error</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:info</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:error</span>)&#x000A;122:       <span class="ruby-ivar">@rye_getenv</span> = {} <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:getenv</span>) <span class="ruby-comment cmt"># Enable getenv with a hash</span>&#x000A;123:       <span class="ruby-ivar">@rye_ostype</span>, <span class="ruby-ivar">@rye_impltype</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:ostype</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:impltype</span>)&#x000A;124:       <span class="ruby-ivar">@rye_quiet</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:quiet</span>)&#x000A;125:       &#x000A;126:       <span class="ruby-comment cmt"># Just in case someone sends a true value rather than IO object</span>&#x000A;127:       <span class="ruby-ivar">@rye_debug</span> = <span class="ruby-constant">STDERR</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_debug</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>&#x000A;128:       <span class="ruby-ivar">@rye_error</span> = <span class="ruby-constant">STDERR</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_error</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>&#x000A;129:       <span class="ruby-ivar">@rye_info</span> = <span class="ruby-constant">STDOUT</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>&#x000A;130:       &#x000A;131:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:logger</span>] = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@rye_debug</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_debug</span> <span class="ruby-comment cmt"># Enable Net::SSH debugging</span>&#x000A;132:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:paranoid</span>] = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_safe</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span> <span class="ruby-comment cmt"># See Net::SSH.start</span>&#x000A;133:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>] = [<span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>]].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;134:       &#x000A;135:       <span class="ruby-comment cmt"># Add the given private keys to the keychain that will be used for @rye_host</span>&#x000A;136:       <span class="ruby-identifier">add_keys</span>(<span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>])&#x000A;137:       &#x000A;138:       <span class="ruby-comment cmt"># We don't want Net::SSH to handle the keypairs. This may change</span>&#x000A;139:       <span class="ruby-comment cmt"># but for we're letting ssh-agent do it. </span>&#x000A;140:       <span class="ruby-comment cmt"># TODO: Check if this should ot should not be enabled. </span>&#x000A;141:       <span class="ruby-comment cmt">#@rye_opts.delete(:keys)</span>&#x000A;142:       &#x000A;143:       <span class="ruby-comment cmt"># From: capistrano/lib/capistrano/cli.rb</span>&#x000A;144:       <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-comment cmt"># so that Net::SSH prompts show up</span>&#x000A;145:       &#x000A;146:       <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ssh-agent info: #{Rye.sshagent_info.inspect}&quot;</span>&#x000A;147:       <span class="ruby-identifier">debug</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">inspect</span>&#x000A;148: &#x000A;149:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M000151'>
                <a name='M000151'>      </a>
                <div class='synopsis'>
                  <span class='name'>==</span>
                  <span class='arguments'>(other)</span>
                </div>
                <div class='description'>
                  <p>
                  Compares itself with the <tt>other</tt> box. If the hostnames are the same,
                  this will return true. Otherwise false.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000151-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000151-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 321</span>&#x000A;321:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)&#x000A;322:       <span class="ruby-ivar">@rye_host</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">host</span>&#x000A;323:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000136'>
                <a name='M000136'>      </a>
                <div class='synopsis'>
                  <span class='name'>[]</span>
                  <span class='arguments'>(fpath=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Change the current working directory (sort of).
                  </p>
                  <p>
                  I haven&#8217;t been able to wrangle Net::SSH to do my bidding. &#8220;My
                  bidding&#8221; in this case, is maintaining an open channel between
                  commands. I&#8217;m using Net::SSH::Connection::Session#exec for all
                  commands which is like a funky helper method that opens a new channel each
                  time it&#8217;s called. This seems to be okay for one-off commands but
                  changing the directory only works for the channel it&#8217;s executed in.
                  The next time exec is called, there&#8217;s a new channel which is back in
                  the default (home) directory.
                  </p>
                  <p>
                  Long story short, the work around is to maintain the current directory
                  locally and send it with each command.
                  </p>
                  <pre>rbox.pwd              # =&gt; /home/rye ($ pwd )&#x000A;rbox['/usr/bin'].pwd  # =&gt; /usr/bin  ($ cd /usr/bin &amp;&amp; pwd)&#x000A;rbox.pwd              # =&gt; /usr/bin  ($ cd /usr/bin &amp;&amp; pwd)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000136-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000136-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 174</span>&#x000A;174:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">fpath</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;175:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">fpath</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">fpath</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value str">'/'</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;176:         <span class="ruby-ivar">@rye_current_working_directory</span> = <span class="ruby-identifier">fpath</span>&#x000A;177:       <span class="ruby-keyword kw">else</span>&#x000A;178:         <span class="ruby-comment cmt"># Append to non-absolute paths</span>&#x000A;179:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_current_working_directory</span>&#x000A;180:           <span class="ruby-identifier">newpath</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@rye_current_working_directory</span>, <span class="ruby-identifier">fpath</span>)&#x000A;181:           <span class="ruby-ivar">@rye_current_working_directory</span> = <span class="ruby-identifier">newpath</span>&#x000A;182:         <span class="ruby-keyword kw">else</span>&#x000A;183:           <span class="ruby-ivar">@rye_current_working_directory</span> = <span class="ruby-identifier">fpath</span>&#x000A;184:         <span class="ruby-keyword kw">end</span>&#x000A;185:       <span class="ruby-keyword kw">end</span>&#x000A;186:       <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;CWD: #{@rye_current_working_directory}&quot;</span>&#x000A;187:       <span class="ruby-keyword kw">self</span>&#x000A;188:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000147'>
                <a name='M000147'>      </a>
                <div class='synopsis'>
                  <span class='name'>add_env</span>
                  <span class='arguments'>(n, v)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="Box.html#M000146">setenv</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000142'>
                <a name='M000142'>      </a>
                <div class='synopsis'>
                  <span class='name'>add_key</span>
                  <span class='arguments'>(*additional_keys)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="Box.html#M000141">add_keys</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000141'>
                <a name='M000141'>      </a>
                <div class='synopsis'>
                  <span class='name'>add_keys</span>
                  <span class='arguments'>(*additional_keys)</span>
                </div>
                <div class='description'>
                  <p>
                  Add one or more private keys to the SSH Agent.
                  </p>
                  <ul>
                  <li><tt>additional_keys</tt> is a list of file paths to private keys
                  
                  </li>
                  </ul>
                  <p>
                  Returns the instance of <a href="Box.html">Box</a>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000141-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000141-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 237</span>&#x000A;237:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_keys</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">additional_keys</span>)&#x000A;238:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>.<span class="ruby-identifier">os</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:windows</span>&#x000A;239:         <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>] <span class="ruby-operator">||=</span> []&#x000A;240:         <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">additional_keys</span>.<span class="ruby-identifier">flatten</span>&#x000A;241:         <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>]&#x000A;242:       <span class="ruby-keyword kw">end</span>&#x000A;243:       <span class="ruby-identifier">additional_keys</span> = [<span class="ruby-identifier">additional_keys</span>].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span> <span class="ruby-operator">||</span> []&#x000A;244:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">additional_keys</span>.<span class="ruby-identifier">empty?</span>&#x000A;245:       <span class="ruby-identifier">ret</span> = <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">add_keys</span>(<span class="ruby-identifier">additional_keys</span>) &#x000A;246:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Rap</span>)&#x000A;247:         <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ssh-add exit_code: #{ret.exit_code}&quot;</span> &#x000A;248:         <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ssh-add stdout: #{ret.stdout}&quot;</span>&#x000A;249:         <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ssh-add stderr: #{ret.stderr}&quot;</span>&#x000A;250:       <span class="ruby-keyword kw">end</span>&#x000A;251:       <span class="ruby-keyword kw">self</span> <span class="ruby-comment cmt"># MUST RETURN self</span>&#x000A;252:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000155'>
                <a name='M000155'>      </a>
                <div class='synopsis'>
                  <span class='name'>authorize_keys_local</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Authorize the current user to login to the local machine via SSH without a
                  password. This is the same functionality as <a
                  href="Box.html#M000154">authorize_keys_remote</a> except run with local
                  shell commands.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000155-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000155-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 449</span>&#x000A;449:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authorize_keys_local</span>&#x000A;450:       <span class="ruby-identifier">added_keys</span> = []&#x000A;451:       <span class="ruby-identifier">ssh_dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>.<span class="ruby-identifier">home</span>, <span class="ruby-value str">'.ssh'</span>)&#x000A;452:       <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>&#x000A;453:         <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;# Public key for #{path}&quot;</span>&#x000A;454:         <span class="ruby-identifier">k</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Key</span>.<span class="ruby-identifier">from_file</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">public_key</span>.<span class="ruby-identifier">to_ssh2</span>&#x000A;455:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir</span> <span class="ruby-identifier">ssh_dir</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span> <span class="ruby-identifier">ssh_dir</span>&#x000A;456:         &#x000A;457:         <span class="ruby-identifier">authkeys_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">ssh_dir</span>, <span class="ruby-value str">'authorized_keys'</span>)&#x000A;458:         &#x000A;459:         <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Writing to #{authkeys_file}&quot;</span>&#x000A;460:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">authkeys_file</span>, <span class="ruby-value str">'a'</span>)       {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-node">&quot;#{$/}#{k}&quot;</span>) }&#x000A;461:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-node">&quot;#{authkeys_file}2&quot;</span>, <span class="ruby-value str">'a'</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-node">&quot;#{$/}#{k}&quot;</span>) }&#x000A;462:         &#x000A;463:         <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>.<span class="ruby-identifier">os</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:windows</span>&#x000A;464:           <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">shell</span>(<span class="ruby-identifier">:chmod</span>, <span class="ruby-value str">'700'</span>, <span class="ruby-identifier">ssh_dir</span>)&#x000A;465:           <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">shell</span>(<span class="ruby-identifier">:chmod</span>, <span class="ruby-value str">'0600'</span>, <span class="ruby-identifier">authkeys_file</span>)&#x000A;466:           <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">shell</span>(<span class="ruby-identifier">:chmod</span>, <span class="ruby-value str">'0600'</span>, <span class="ruby-node">&quot;#{authkeys_file}2&quot;</span>)&#x000A;467:         <span class="ruby-keyword kw">end</span>&#x000A;468:         &#x000A;469:         <span class="ruby-identifier">added_keys</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">path</span>&#x000A;470:       <span class="ruby-keyword kw">end</span>&#x000A;471:       <span class="ruby-identifier">added_keys</span>&#x000A;472:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000154'>
                <a name='M000154'>      </a>
                <div class='synopsis'>
                  <span class='name'>authorize_keys_remote</span>
                  <span class='arguments'>(other_user=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Copy the local public keys (as specified by <a
                  href="../Rye.html#M000007">Rye.keys</a>) to this box into
                  ~/.ssh/authorized_keys and ~/.ssh/authorized_keys2. Returns a <a
                  href="Rap.html">Rye::Rap</a> object. The private keys files used to
                  generate the public keys are contained in stdout. Raises a Rye::ComandError
                  if the home directory doesn&#8217;t exit. NOTE: <a
                  href="Box.html#M000154">authorize_keys_remote</a> disables safe-mode for
                  this box while it runs which will hit you funky style if your using a
                  single instance of <a href="Box.html">Rye::Box</a> in a multithreaded
                  situation.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000154-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000154-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 385</span>&#x000A;385:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authorize_keys_remote</span>(<span class="ruby-identifier">other_user</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;386:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">other_user</span>.<span class="ruby-identifier">nil?</span>&#x000A;387:         <span class="ruby-identifier">this_user</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:user</span>]&#x000A;388:         <span class="ruby-identifier">homedir</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">quietly</span> { <span class="ruby-identifier">pwd</span> }.<span class="ruby-identifier">first</span>&#x000A;389:       <span class="ruby-keyword kw">else</span>&#x000A;390:         <span class="ruby-identifier">this_user</span> = <span class="ruby-identifier">other_user</span> &#x000A;391:         <span class="ruby-comment cmt"># The homedir path is important b/c this is where we're going to </span>&#x000A;392:         <span class="ruby-comment cmt"># look for the .ssh directory. That's where auth love is stored.</span>&#x000A;393:         <span class="ruby-identifier">homedir</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">guess_user_home</span>(<span class="ruby-identifier">this_user</span>)&#x000A;394:       <span class="ruby-keyword kw">end</span>&#x000A;395:       &#x000A;396:       <span class="ruby-identifier">added_keys</span> = []&#x000A;397:       <span class="ruby-identifier">rap</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Rap</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>)&#x000A;398:       &#x000A;399:       <span class="ruby-identifier">prevdir</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">current_working_directory</span>&#x000A;400:       &#x000A;401:       <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">file_exists?</span>(<span class="ruby-identifier">homedir</span>)&#x000A;402:         <span class="ruby-identifier">rap</span>.<span class="ruby-identifier">add_exit_code</span>(<span class="ruby-value">1</span>)&#x000A;403:         <span class="ruby-identifier">rap</span>.<span class="ruby-identifier">add_stderr</span>(<span class="ruby-node">&quot;Path does not exist: #{homedir}&quot;</span>)&#x000A;404:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">CommandError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">rap</span>)&#x000A;405:       <span class="ruby-keyword kw">end</span>&#x000A;406:       &#x000A;407:       <span class="ruby-comment cmt"># Let's go into the user's home directory that we now know exists.</span>&#x000A;408:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cd</span> <span class="ruby-identifier">homedir</span>&#x000A;409:       &#x000A;410:       <span class="ruby-identifier">files</span> = [<span class="ruby-value str">'.ssh/authorized_keys'</span>, <span class="ruby-value str">'.ssh/authorized_keys2'</span>, <span class="ruby-value str">'.ssh/identity'</span>]&#x000A;411:       <span class="ruby-identifier">files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">akey_path</span><span class="ruby-operator">|</span>&#x000A;412:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">file_exists?</span>(<span class="ruby-identifier">akey_path</span>)&#x000A;413:           <span class="ruby-comment cmt"># TODO: Make Rye::Cmd.incremental_backup</span>&#x000A;414:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cp</span>(<span class="ruby-identifier">akey_path</span>, <span class="ruby-node">&quot;#{akey_path}-previous&quot;</span>)&#x000A;415:           <span class="ruby-identifier">authorized_keys</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">file_download</span>(<span class="ruby-node">&quot;#{homedir}/#{akey_path}&quot;</span>)&#x000A;416:         <span class="ruby-keyword kw">end</span>&#x000A;417:         <span class="ruby-identifier">authorized_keys</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>&#x000A;418:         &#x000A;419:         <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>&#x000A;420:           &#x000A;421:           <span class="ruby-identifier">info</span> <span class="ruby-node">&quot;# Adding public key for #{path}&quot;</span>&#x000A;422:           <span class="ruby-identifier">k</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Key</span>.<span class="ruby-identifier">from_file</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">public_key</span>.<span class="ruby-identifier">to_ssh2</span>&#x000A;423:           <span class="ruby-identifier">authorized_keys</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">k</span>&#x000A;424:         <span class="ruby-keyword kw">end</span>&#x000A;425:         &#x000A;426:         <span class="ruby-comment cmt"># Remove duplicate authorized keys</span>&#x000A;427:         <span class="ruby-identifier">authorized_keys</span>.<span class="ruby-identifier">rewind</span>&#x000A;428:         <span class="ruby-identifier">uniqlines</span> = <span class="ruby-identifier">authorized_keys</span>.<span class="ruby-identifier">readlines</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">join</span>&#x000A;429:         <span class="ruby-identifier">authorized_keys</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uniqlines</span>)&#x000A;430:         <span class="ruby-comment cmt"># We need to rewind so that all of the StringIO object is uploaded</span>&#x000A;431:         <span class="ruby-identifier">authorized_keys</span>.<span class="ruby-identifier">rewind</span>&#x000A;432:         &#x000A;433:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">:p</span>, <span class="ruby-identifier">:m</span>, <span class="ruby-value str">'700'</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">akey_path</span>))&#x000A;434:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">file_upload</span>(<span class="ruby-identifier">authorized_keys</span>, <span class="ruby-node">&quot;#{homedir}/#{akey_path}&quot;</span>)&#x000A;435:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">chmod</span>(<span class="ruby-value str">'0600'</span>, <span class="ruby-identifier">akey_path</span>)&#x000A;436:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">chown</span>(<span class="ruby-identifier">:R</span>, <span class="ruby-identifier">this_user</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">akey_path</span>))&#x000A;437:       <span class="ruby-keyword kw">end</span>&#x000A;438:       &#x000A;439:       <span class="ruby-comment cmt"># And let's return to the directory we came from.</span>&#x000A;440:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">cd</span> <span class="ruby-identifier">prevdir</span>&#x000A;441:       &#x000A;442:       <span class="ruby-identifier">rap</span>.<span class="ruby-identifier">add_exit_code</span>(<span class="ruby-value">0</span>)&#x000A;443:       <span class="ruby-identifier">rap</span>&#x000A;444:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000161'>
                <a name='M000161'>      </a>
                <div class='synopsis'>
                  <span class='name'>batch</span>
                  <span class='arguments'>(*args, &amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  Execute a block in the context of an instance of <a
                  href="Box.html">Rye::Box</a>.
                  </p>
                  <pre>rbox = Rye::Box.new&#x000A;&#x000A;rbox.batch do&#x000A;  ls :l&#x000A;  uname :a&#x000A;end</pre>
                  <p>
                  OR
                  </p>
                  <pre>rbox.batch(&amp;block)</pre>
                  <p>
                  The batch can also accept arguments.
                  </p>
                  <pre>rbox.batch('path/2/file') do |file|&#x000A;  ls :l file&#x000A;end</pre>
                  <p>
                  Returns the return value of the block.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000161-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000161-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 549</span>&#x000A;549:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">batch</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;550:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_exec</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>&#x000A;551:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000137'>
                <a name='M000137'>      </a>
                <div class='synopsis'>
                  <span class='name'>cd</span>
                  <span class='arguments'>(fpath=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Like [] except it returns an empty <a href="Rap.html">Rye::Rap</a> object
                  to mimick a regular command method. Call with nil key (or no arg) to reset.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000137-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000137-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 192</span>&#x000A;192:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cd</span>(<span class="ruby-identifier">fpath</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;193:       <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Rap</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">fpath</span>])&#x000A;194:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000167'>
                <a name='M000167'>      </a>
                <div class='synopsis'>
                  <span class='name'>connect</span>
                  <span class='arguments'>(reconnect=true)</span>
                </div>
                <div class='description'>
                  <p>
                  Open an SSH session with +@rye_host+. This called automatically when you
                  the first comamnd is run if it&#8217;s not already connected. Raises a <a
                  href="NoHost.html">Rye::NoHost</a> exception if +@rye_host+ is not
                  specified. Will attempt a password login up to 3 times if the initial
                  authentication fails.
                  </p>
                  <ul>
                  <li><tt>reconnect</tt> Disconnect first if already connected. The default
                  
                  </li>
                  </ul>
                  <p>
                  is true. When set to false, connect will do nothing if already connected.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000167-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000167-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 629</span>&#x000A;629:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">connect</span>(<span class="ruby-identifier">reconnect</span>=<span class="ruby-keyword kw">true</span>)&#x000A;630:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">NoHost</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_host</span>&#x000A;631:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reconnect</span>&#x000A;632:       <span class="ruby-identifier">disconnect</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_ssh</span> &#x000A;633:       <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Opening connection to #{@rye_host} as #{@rye_user}&quot;</span>&#x000A;634:       <span class="ruby-identifier">highline</span> = <span class="ruby-constant">HighLine</span>.<span class="ruby-identifier">new</span> <span class="ruby-comment cmt"># Used for password prompt</span>&#x000A;635:       <span class="ruby-identifier">retried</span> = <span class="ruby-value">0</span>&#x000A;636:       <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:keys</span>].<span class="ruby-identifier">compact!</span>  <span class="ruby-comment cmt"># A quick fix in Windows. TODO: Why is there a nil?</span>&#x000A;637:       <span class="ruby-keyword kw">begin</span>&#x000A;638:         <span class="ruby-ivar">@rye_ssh</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span>.<span class="ruby-identifier">start</span>(<span class="ruby-ivar">@rye_host</span>, <span class="ruby-ivar">@rye_user</span>, <span class="ruby-ivar">@rye_opts</span> <span class="ruby-operator">||</span> {}) &#x000A;639:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">HostKeyMismatch</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;640:         <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">message</span>&#x000A;641:         <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\a&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-comment cmt"># Ring the bell</span>&#x000A;642:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">highline</span>.<span class="ruby-identifier">ask</span>(<span class="ruby-value str">&quot;Continue? &quot;</span>).<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp re">/\Ay|yes|sure|ya\z/i</span>)&#x000A;643:           <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:paranoid</span>] = <span class="ruby-keyword kw">false</span>&#x000A;644:           <span class="ruby-keyword kw">retry</span>&#x000A;645:         <span class="ruby-keyword kw">else</span>&#x000A;646:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">HostKeyMismatch</span>&#x000A;647:         <span class="ruby-keyword kw">end</span>&#x000A;648:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">AuthenticationFailed</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;649:         <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\a&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">retried</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-comment cmt"># Ring the bell once</span>&#x000A;650:         <span class="ruby-identifier">retried</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;651:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">STDIN</span>.<span class="ruby-identifier">tty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">retried</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>&#x000A;652:           <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Passwordless login failed for #{@rye_user}&quot;</span>&#x000A;653:           <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:password</span>] = <span class="ruby-identifier">highline</span>.<span class="ruby-identifier">ask</span>(<span class="ruby-value str">&quot;Password: &quot;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">echo</span> = <span class="ruby-value str">''</span> }&#x000A;654:           <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:auth_methods</span>] <span class="ruby-operator">||=</span> []&#x000A;655:           <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-identifier">:auth_methods</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'password'</span>&#x000A;656:           <span class="ruby-keyword kw">retry</span>&#x000A;657:         <span class="ruby-keyword kw">else</span>&#x000A;658:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">AuthenticationFailed</span>&#x000A;659:         <span class="ruby-keyword kw">end</span>&#x000A;660:       <span class="ruby-keyword kw">end</span>&#x000A;661:       &#x000A;662:       <span class="ruby-comment cmt"># We add :auth_methods (a Net::SSH joint) to force asking for a</span>&#x000A;663:       <span class="ruby-comment cmt"># password if the initial (key-based) authentication fails. We</span>&#x000A;664:       <span class="ruby-comment cmt"># need to delete the key from @rye_opts otherwise it lingers until</span>&#x000A;665:       <span class="ruby-comment cmt"># the next connection (if we switch_user is called for example).</span>&#x000A;666:       <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">:auth_methods</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:auth_methods</span>)&#x000A;667:       &#x000A;668:       <span class="ruby-keyword kw">self</span>&#x000A;669:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000125'>
                <a name='M000125'>      </a>
                <div class='synopsis'>
                  <span class='name'>current_umask</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  The most recent valud for umask (or 0022)
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000125-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000125-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 60</span>&#x000A;60:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_umask</span>; <span class="ruby-ivar">@rye_current_umask</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000124'>
                <a name='M000124'>      </a>
                <div class='synopsis'>
                  <span class='name'>current_working_directory</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  The most recent value from <a href="Box.html#M000137">Box.cd</a> or <a
                  href="Box.html">Box</a>.[]
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000124-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000124-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 57</span>&#x000A;57:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_working_directory</span>; <span class="ruby-ivar">@rye_current_working_directory</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000127'>
                <a name='M000127'>      </a>
                <div class='synopsis'>
                  <span class='name'>debug</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000127-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000127-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 63</span>&#x000A;63:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">debug</span>; <span class="ruby-ivar">@rye_debug</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000123'>
                <a name='M000123'>      </a>
                <div class='synopsis'>
                  <span class='name'>disable_quiet_mode</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000123-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000123-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 54</span>&#x000A;54:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disable_quiet_mode</span>; <span class="ruby-ivar">@rye_quiet</span> = <span class="ruby-keyword kw">false</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000120'>
                <a name='M000120'>      </a>
                <div class='synopsis'>
                  <span class='name'>disable_safe_mode</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000120-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000120-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 50</span>&#x000A;50:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disable_safe_mode</span>; <span class="ruby-ivar">@rye_safe</span> = <span class="ruby-keyword kw">false</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000168'>
                <a name='M000168'>      </a>
                <div class='synopsis'>
                  <span class='name'>disconnect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Close the SSH session with +@rye_host+. This is called automatically at
                  exit if the connection is open.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000168-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000168-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 673</span>&#x000A;673:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disconnect</span>&#x000A;674:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">closed?</span>&#x000A;675:       <span class="ruby-keyword kw">begin</span>&#x000A;676:         <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-identifier">timeout</span>(<span class="ruby-value">10</span>) <span class="ruby-keyword kw">do</span>&#x000A;677:           <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">loop</span>(<span class="ruby-value">0</span><span class="ruby-value">.3</span>) { <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">busy?</span>; }&#x000A;678:         <span class="ruby-keyword kw">end</span>&#x000A;679:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;680:         <span class="ruby-identifier">error</span> <span class="ruby-value str">&quot;Disconnect timeout (was something still running?)&quot;</span>&#x000A;681:       <span class="ruby-keyword kw">end</span>&#x000A;682:       &#x000A;683:       <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Closing connection to #{@rye_ssh.host}&quot;</span>&#x000A;684:       <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">close</span>&#x000A;685:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000122'>
                <a name='M000122'>      </a>
                <div class='synopsis'>
                  <span class='name'>enable_quiet_mode</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000122-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000122-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 53</span>&#x000A;53:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">enable_quiet_mode</span>;  <span class="ruby-ivar">@rye_quiet</span> = <span class="ruby-keyword kw">true</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000119'>
                <a name='M000119'>      </a>
                <div class='synopsis'>
                  <span class='name'>enable_safe_mode</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000119-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000119-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 49</span>&#x000A;49:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">enable_safe_mode</span>;  <span class="ruby-ivar">@rye_safe</span> = <span class="ruby-keyword kw">true</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000128'>
                <a name='M000128'>      </a>
                <div class='synopsis'>
                  <span class='name'>error</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000128-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000128-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 64</span>&#x000A;64:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">error</span>; <span class="ruby-ivar">@rye_error</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000160'>
                <a name='M000160'>      </a>
                <div class='synopsis'>
                  <span class='name'>exception_hook</span>
                  <span class='arguments'>(klass, &amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  Supply a block to be called whenever there&#8217;s an Exception. It&#8217;s
                  called with 1 argument: the exception class. If the exception block returns
                  :retry, the command will be executed again.
                  </p>
                  <p>
                  e.g.
                  </p>
                  <pre>rbox.exception_hook(CommandNotFound) do |ex|&#x000A;  STDERR.puts &quot;An error occurred: #{ex.class}&quot;&#x000A;  choice = Annoy.get_user_input('(S)kip  (R)etry  (A)bort: ')&#x000A;  if choice == 'R'&#x000A;    :retry&#x000A;  elsif choice == 'S'&#x000A;    # do nothing&#x000A;  else&#x000A;    exit  # !&#x000A;  end&#x000A;end</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000160-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000160-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 525</span>&#x000A;525:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exception_hook</span>(<span class="ruby-identifier">klass</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;526:       <span class="ruby-ivar">@rye_exception_hook</span>[<span class="ruby-identifier">klass</span>] = <span class="ruby-identifier">block</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>&#x000A;527:       <span class="ruby-ivar">@rye_exception_hook</span>[<span class="ruby-identifier">klass</span>]&#x000A;528:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000133'>
                <a name='M000133'>      </a>
                <div class='synopsis'>
                  <span class='name'>exception_hook=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='description'>
                  <p>
                  A Hash. The keys are exception classes, the values are Procs to execute
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000133-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000133-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 71</span>&#x000A;71:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exception_hook=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_exception_hook</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000157'>
                <a name='M000157'>      </a>
                <div class='synopsis'>
                  <span class='name'>execute</span>
                  <span class='arguments'>(cmd, *args, &amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="Box.html#M000156">method_missing</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000145'>
                <a name='M000145'>      </a>
                <div class='synopsis'>
                  <span class='name'>getenv</span>
                  <span class='arguments'>(key=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Returns the hash containing the parsed output of &#8220;env&#8221; on the
                  remote machine. If the initialize option <tt>:getenv</tt> was set to false,
                  this will return an empty hash. This is a lazy loaded method so it fetches
                  the remote envvars the first time this method is called.
                  </p>
                  <pre>puts rbox.getenv['HOME']    # =&gt; &quot;/home/gloria&quot; (remote)</pre>
                  <p>
                  NOTE: This method should not raise an exception under normal circumstances.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000145-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000145-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 281</span>&#x000A;281:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">getenv</span>(<span class="ruby-identifier">key</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;282:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_getenv</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rye_getenv</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">can?</span>(<span class="ruby-identifier">:env</span>)&#x000A;283:         <span class="ruby-identifier">vars</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">quietly</span> { <span class="ruby-identifier">env</span> } <span class="ruby-keyword kw">rescue</span> []&#x000A;284:         <span class="ruby-identifier">vars</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">nvpair</span><span class="ruby-operator">|</span> &#x000A;285:           <span class="ruby-comment cmt"># Parse &quot;GLORIA_HOME=/gloria/lives/here&quot; into a name/value</span>&#x000A;286:           <span class="ruby-comment cmt"># pair. The regexp ensures we split only at the 1st = sign</span>&#x000A;287:           <span class="ruby-identifier">n</span>, <span class="ruby-identifier">v</span> = <span class="ruby-identifier">nvpair</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/\A([\w_-]+?)=(.+)\z/</span>).<span class="ruby-identifier">flatten</span>&#x000A;288:           <span class="ruby-ivar">@rye_getenv</span>[<span class="ruby-identifier">n</span>] = <span class="ruby-identifier">v</span>&#x000A;289:         <span class="ruby-keyword kw">end</span>&#x000A;290:       <span class="ruby-keyword kw">end</span>&#x000A;291:       <span class="ruby-identifier">key</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-ivar">@rye_getenv</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rye_getenv</span>[<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>]&#x000A;292:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000153'>
                <a name='M000153'>      </a>
                <div class='synopsis'>
                  <span class='name'>guess_user_home</span>
                  <span class='arguments'>(other_user=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Uses the output of &#8220;useradd -D&#8221; to determine the default home
                  directory. This returns a GUESS rather than the a user&#8217;s real home
                  directory. Currently used only by authorize_keys_remote. Only useful before
                  you&#8217;ve logged in. Otherwise check $HOME
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000153-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000153-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 335</span>&#x000A;335:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">guess_user_home</span>(<span class="ruby-identifier">other_user</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;336:       <span class="ruby-identifier">this_user</span> = <span class="ruby-identifier">other_user</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:user</span>]&#x000A;337:       <span class="ruby-ivar">@rye_guessed_homes</span> <span class="ruby-operator">||=</span> {}&#x000A;338:       &#x000A;339:       <span class="ruby-comment cmt"># A simple cache. </span>&#x000A;340:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@rye_guessed_homes</span>[<span class="ruby-identifier">this_user</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_guessed_homes</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">this_user</span>)&#x000A;341:       &#x000A;342:       <span class="ruby-comment cmt"># Some junk to determine where user home directories are by default.</span>&#x000A;343:       <span class="ruby-comment cmt"># We're relying on the command &quot;useradd -D&quot; so this may not work on</span>&#x000A;344:       <span class="ruby-comment cmt"># different Linuxen and definitely won't work on Windows.</span>&#x000A;345:       <span class="ruby-comment cmt"># This code will be abstracted out once I find a decent home for it.</span>&#x000A;346:       <span class="ruby-comment cmt"># /etc/default/useradd, HOME=/home OR useradd -D</span>&#x000A;347:       <span class="ruby-comment cmt"># /etc/adduser.config, DHOME=/home OR ??</span>&#x000A;348:       <span class="ruby-identifier">user_defaults</span> = {}&#x000A;349:       <span class="ruby-identifier">ostmp</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ostype</span>&#x000A;350:       <span class="ruby-identifier">ostmp</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">ostype</span>.<span class="ruby-identifier">to_s</span>&#x000A;351:       &#x000A;352:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ostmp</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;sunos&quot;</span>&#x000A;353:         <span class="ruby-comment cmt">#nv.scan(/([\w_-]+?)=(.+?)\s/).each do |n, v|</span>&#x000A;354:         <span class="ruby-comment cmt">#  n = 'HOME' if n == 'basedir'</span>&#x000A;355:         <span class="ruby-comment cmt">#  user_defaults[n.upcase] = v.strip</span>&#x000A;356:         <span class="ruby-comment cmt">#end</span>&#x000A;357:         <span class="ruby-comment cmt"># In Solaris, useradd -D says the default home path is /home</span>&#x000A;358:         <span class="ruby-comment cmt"># but that directory is not writable. See: http://bit.ly/IJDD0</span>&#x000A;359:         <span class="ruby-identifier">user_defaults</span>[<span class="ruby-value str">'HOME'</span>] = <span class="ruby-value str">'/export/home'</span>&#x000A;360:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ostmp</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;darwin&quot;</span>&#x000A;361:         <span class="ruby-identifier">user_defaults</span>[<span class="ruby-value str">'HOME'</span>] = <span class="ruby-value str">'/Users'</span>&#x000A;362:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ostmp</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;windows&quot;</span>&#x000A;363:         <span class="ruby-identifier">user_defaults</span>[<span class="ruby-value str">'HOME'</span>] = <span class="ruby-value str">'C:/Documents and Settings'</span>&#x000A;364:       <span class="ruby-keyword kw">else</span>&#x000A;365:         <span class="ruby-identifier">raw</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">quietly</span> { <span class="ruby-identifier">useradd</span>(<span class="ruby-identifier">:D</span>) } <span class="ruby-keyword kw">rescue</span> []&#x000A;366:         <span class="ruby-identifier">raw</span> = [<span class="ruby-value str">&quot;HOME=/home&quot;</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">empty?</span>&#x000A;367:         <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">nv</span><span class="ruby-operator">|</span>&#x000A;368:           <span class="ruby-identifier">n</span>, <span class="ruby-identifier">v</span> = <span class="ruby-identifier">nv</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/\A([\w_-]+?)=(.+)\z/</span>).<span class="ruby-identifier">flatten</span>&#x000A;369:           <span class="ruby-identifier">user_defaults</span>[<span class="ruby-identifier">n</span>] = <span class="ruby-identifier">v</span>&#x000A;370:         <span class="ruby-keyword kw">end</span>&#x000A;371:       <span class="ruby-keyword kw">end</span>&#x000A;372:       &#x000A;373:       <span class="ruby-ivar">@rye_guessed_homes</span>[<span class="ruby-identifier">this_user</span>] = <span class="ruby-node">&quot;#{user_defaults['HOME']}/#{this_user}&quot;</span>&#x000A;374:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000108'>
                <a name='M000108'>      </a>
                <div class='synopsis'>
                  <span class='name'>host</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000108-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000108-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 32</span>&#x000A;32:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">host</span>; <span class="ruby-ivar">@rye_host</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000115'>
                <a name='M000115'>      </a>
                <div class='synopsis'>
                  <span class='name'>host=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000115-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000115-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 42</span>&#x000A;42:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">host=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_host</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000152'>
                <a name='M000152'>      </a>
                <div class='synopsis'>
                  <span class='name'>host_key</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns the host SSH keys for this box
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000152-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000152-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 326</span>&#x000A;326:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">host_key</span>&#x000A;327:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;No host&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_host</span>&#x000A;328:       <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">remote_host_keys</span>(<span class="ruby-ivar">@rye_host</span>)&#x000A;329:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000144'>
                <a name='M000144'>      </a>
                <div class='synopsis'>
                  <span class='name'>impltype</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000144-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000144-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 266</span>&#x000A;266:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">impltype</span>&#x000A;267:       <span class="ruby-ivar">@rye_impltype</span>&#x000A;268:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000130'>
                <a name='M000130'>      </a>
                <div class='synopsis'>
                  <span class='name'>impltype=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000130-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000130-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 67</span>&#x000A;67:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">impltype=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_impltype</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000126'>
                <a name='M000126'>      </a>
                <div class='synopsis'>
                  <span class='name'>info</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000126-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000126-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 62</span>&#x000A;62:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">info</span>; <span class="ruby-ivar">@rye_info</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000150'>
                <a name='M000150'>      </a>
                <div class='synopsis'>
                  <span class='name'>inspect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000150-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000150-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 311</span>&#x000A;311:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>&#x000A;312:       <span class="ruby-value str">%q{#&lt;%s:%s name=%s cwd=%s umask=%s env=%s safe=%s opts=%s keys=%s&gt;}</span> <span class="ruby-operator">%</span> &#x000A;313:       [<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">nickname</span>,&#x000A;314:        <span class="ruby-ivar">@rye_current_working_directory</span>, <span class="ruby-ivar">@rye_current_umask</span>,&#x000A;315:        (<span class="ruby-ivar">@rye_current_environment_variables</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>).<span class="ruby-identifier">inspect</span>,&#x000A;316:        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">safe</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">inspect</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">inspect</span>]&#x000A;317:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000165'>
                <a name='M000165'>      </a>
                <div class='synopsis'>
                  <span class='name'>instance_exec</span>
                  <span class='arguments'>(*args, &amp;block)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000165-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000165-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 595</span>&#x000A;595:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">instance_exec</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-comment cmt"># !&gt; method redefined; discarding old instance_exec</span>&#x000A;596:         <span class="ruby-identifier">mname</span> = <span class="ruby-node">&quot;__instance_exec_#{Thread.current.object_id.abs}_#{object_id.abs}&quot;</span>&#x000A;597:         <span class="ruby-constant">InstanceExecHelper</span>.<span class="ruby-identifier">module_eval</span>{ <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">mname</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) }&#x000A;598:         <span class="ruby-keyword kw">begin</span>&#x000A;599:           <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">send</span>(<span class="ruby-identifier">mname</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;600:         <span class="ruby-keyword kw">ensure</span>&#x000A;601:           <span class="ruby-constant">InstanceExecHelper</span>.<span class="ruby-identifier">module_eval</span>{ <span class="ruby-identifier">undef_method</span>(<span class="ruby-identifier">mname</span>) } <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>&#x000A;602:         <span class="ruby-keyword kw">end</span>&#x000A;603:         <span class="ruby-identifier">ret</span>&#x000A;604:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000140'>
                <a name='M000140'>      </a>
                <div class='synopsis'>
                  <span class='name'>interactive_ssh</span>
                  <span class='arguments'>(run=true)</span>
                </div>
                <div class='description'>
                  <p>
                  Open an interactive SSH session. This only works if STDIN.tty? returns
                  true. Otherwise it returns the SSH command that would have been run. This
                  requires the SSH command-line executable (ssh).
                  </p>
                  <ul>
                  <li><tt>run</tt> when set to false, it will return the SSH command as a String
                  
                  </li>
                  </ul>
                  <p>
                  and not open an SSH session.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000140-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000140-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 226</span>&#x000A;226:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">interactive_ssh</span>(<span class="ruby-identifier">run</span>=<span class="ruby-keyword kw">true</span>)&#x000A;227:       <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;interactive_ssh with keys: #{Rye.keys.inspect}&quot;</span>&#x000A;228:       <span class="ruby-identifier">run</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">STDIN</span>.<span class="ruby-identifier">tty?</span>      &#x000A;229:       <span class="ruby-identifier">cmd</span> = <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">prepare_command</span>(<span class="ruby-value str">&quot;ssh&quot;</span>, <span class="ruby-node">&quot;#{@rye_user}@#{@rye_host}&quot;</span>)&#x000A;230:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">cmd</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">run</span>&#x000A;231:       <span class="ruby-identifier">system</span>(<span class="ruby-identifier">cmd</span>)&#x000A;232:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000148'>
                <a name='M000148'>      </a>
                <div class='synopsis'>
                  <span class='name'>keys</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  See <a href="../Rye.html#M000007">Rye.keys</a>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000148-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000148-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 306</span>&#x000A;306:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">keys</span>; <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000156'>
                <a name='M000156'>      </a>
                <div class='synopsis'>
                  <span class='name'>method_missing</span>
                  <span class='arguments'>(cmd, *args, &amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  A handler for undefined commands. Raises <a
                  href="CommandNotFound.html">Rye::CommandNotFound</a> exception.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000156-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000156-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 476</span>&#x000A;476:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;477:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_safe</span>&#x000A;478:         <span class="ruby-identifier">ex</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">CommandNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">to_s</span>)&#x000A;479:         <span class="ruby-identifier">raise</span> <span class="ruby-identifier">ex</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_exception_hook</span>.<span class="ruby-identifier">has_key?</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">class</span>&#x000A;480:         <span class="ruby-ivar">@rye_exception_hook</span>[<span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">CommandNotFound</span>].<span class="ruby-identifier">call</span> <span class="ruby-identifier">ex</span>&#x000A;481:       <span class="ruby-keyword kw">else</span>&#x000A;482:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>&#x000A;483:           <span class="ruby-identifier">run_command</span> <span class="ruby-identifier">cmd</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>&#x000A;484:         <span class="ruby-keyword kw">else</span>&#x000A;485:           <span class="ruby-identifier">ex</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">CommandNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">to_s</span>)&#x000A;486:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">ex</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@rye_exception_hook</span>.<span class="ruby-identifier">has_key?</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">class</span>&#x000A;487:         <span class="ruby-keyword kw">end</span>&#x000A;488:       <span class="ruby-keyword kw">end</span>&#x000A;489:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000114'>
                <a name='M000114'>      </a>
                <div class='synopsis'>
                  <span class='name'>nickname</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000114-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000114-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 40</span>&#x000A;40:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nickname</span>; <span class="ruby-ivar">@rye_nickname</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">host</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000118'>
                <a name='M000118'>      </a>
                <div class='synopsis'>
                  <span class='name'>nickname=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000118-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000118-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 47</span>&#x000A;47:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nickname=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_nickname</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000109'>
                <a name='M000109'>      </a>
                <div class='synopsis'>
                  <span class='name'>opts</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000109-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000109-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 33</span>&#x000A;33:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">opts</span>; <span class="ruby-ivar">@rye_opts</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000116'>
                <a name='M000116'>      </a>
                <div class='synopsis'>
                  <span class='name'>opts=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000116-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000116-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 43</span>&#x000A;43:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">opts=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_opts</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000143'>
                <a name='M000143'>      </a>
                <div class='synopsis'>
                  <span class='name'>ostype</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Return the value of uname in lowercase This is a temporary fix. We can use
                  SysInfo for this, upload it, execute it directly, parse the output.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000143-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000143-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 258</span>&#x000A;258:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ostype</span>&#x000A;259:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@rye_ostype</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rye_ostype</span> <span class="ruby-comment cmt"># simple cache</span>&#x000A;260:       <span class="ruby-identifier">os</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">quietly</span> { <span class="ruby-identifier">uname</span>.<span class="ruby-identifier">first</span> } <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>&#x000A;261:       <span class="ruby-identifier">os</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">'unknown'</span>&#x000A;262:       <span class="ruby-identifier">os</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">os</span>.<span class="ruby-identifier">downcase</span>&#x000A;263:       <span class="ruby-ivar">@rye_ostype</span> = <span class="ruby-identifier">os</span>&#x000A;264:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000129'>
                <a name='M000129'>      </a>
                <div class='synopsis'>
                  <span class='name'>ostype=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000129-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000129-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 66</span>&#x000A;66:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ostype=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_ostype</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000166'>
                <a name='M000166'>      </a>
                <div class='synopsis'>
                  <span class='name'>post_command_hook</span>
                  <span class='arguments'>(&amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  Supply a block to be called after every command. It&#8217;s called with one
                  argument: an instance of <a href="Rap.html">Rye::Rap</a>.
                  </p>
                  <p>
                  When this block is supplied, the command does not raise an exception when
                  the exit code is greater than 0 (the typical behavior) so the block needs
                  to check the <a href="Rap.html">Rye::Rap</a> object to determine whether an
                  exception should be raised.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000166-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000166-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 614</span>&#x000A;614:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post_command_hook</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;615:       <span class="ruby-ivar">@rye_post_command_hook</span> = <span class="ruby-identifier">block</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>&#x000A;616:       <span class="ruby-ivar">@rye_post_command_hook</span>&#x000A;617:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000132'>
                <a name='M000132'>      </a>
                <div class='synopsis'>
                  <span class='name'>post_command_hook=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000132-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000132-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 69</span>&#x000A;69:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post_command_hook=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_post_command_hook</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000159'>
                <a name='M000159'>      </a>
                <div class='synopsis'>
                  <span class='name'>pre_command_hook</span>
                  <span class='arguments'>(&amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  Supply a block to be called before every command. It&#8217;s called with
                  three arguments: command name, an Array of arguments, user name, hostname
                  e.g.
                  </p>
                  <pre>rbox.pre_command_hook do |cmd,args,user,host|&#x000A;  ...&#x000A;end</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000159-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000159-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 504</span>&#x000A;504:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pre_command_hook</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;505:       <span class="ruby-ivar">@rye_pre_command_hook</span> = <span class="ruby-identifier">block</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>&#x000A;506:       <span class="ruby-ivar">@rye_pre_command_hook</span>&#x000A;507:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000131'>
                <a name='M000131'>      </a>
                <div class='synopsis'>
                  <span class='name'>pre_command_hook=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000131-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000131-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 68</span>&#x000A;68:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pre_command_hook=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_pre_command_hook</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000158'>
                <a name='M000158'>      </a>
                <div class='synopsis'>
                  <span class='name'>preview_command</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='description'>
                  <p>
                  Returns the command an arguments as a String.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000158-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000158-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 493</span>&#x000A;493:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">preview_command</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;494:       <span class="ruby-identifier">prep_args</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>).<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>)&#x000A;495:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000113'>
                <a name='M000113'>      </a>
                <div class='synopsis'>
                  <span class='name'>quiet</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000113-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000113-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 39</span>&#x000A;39:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quiet</span>; <span class="ruby-ivar">@rye_quiet</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000164'>
                <a name='M000164'>      </a>
                <div class='synopsis'>
                  <span class='name'>quietly</span>
                  <span class='arguments'>(*args, &amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  Like batch, except it enables quiet mode before executing the block. After
                  executing the block, quiet mode is returned back to whichever state it was
                  previously in. In other words, this method won&#8217;t enable quiet mode if
                  it was already disabled.
                  </p>
                  <p>
                  In quiet mode, the pre and post command hooks are not called. This is used
                  internally when calling commands like <tt>ls</tt> to check whether a file
                  path exists (to prevent polluting the logs).
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000164-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000164-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 582</span>&#x000A;582:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quietly</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;583:       <span class="ruby-identifier">previous_state</span> = <span class="ruby-ivar">@rye_quiet</span>&#x000A;584:       <span class="ruby-identifier">enable_quiet_mode</span>&#x000A;585:       <span class="ruby-identifier">ret</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_exec</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>&#x000A;586:       <span class="ruby-ivar">@rye_quiet</span> = <span class="ruby-identifier">previous_state</span>&#x000A;587:       <span class="ruby-identifier">ret</span>&#x000A;588:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000110'>
                <a name='M000110'>      </a>
                <div class='synopsis'>
                  <span class='name'>safe</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000110-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000110-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 34</span>&#x000A;34:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">safe</span>; <span class="ruby-ivar">@rye_safe</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000121'>
                <a name='M000121'>      </a>
                <div class='synopsis'>
                  <span class='name'>safe?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000121-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000121-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 51</span>&#x000A;51:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">safe?</span>; <span class="ruby-ivar">@rye_safe</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000163'>
                <a name='M000163'>      </a>
                <div class='synopsis'>
                  <span class='name'>safely</span>
                  <span class='arguments'>(*args, &amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  See unsafely (except in reverse)
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000163-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000163-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 566</span>&#x000A;566:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">safely</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;567:       <span class="ruby-identifier">previous_state</span> = <span class="ruby-ivar">@rye_safe</span>&#x000A;568:       <span class="ruby-identifier">enable_safe_mode</span>&#x000A;569:       <span class="ruby-identifier">ret</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_exec</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>&#x000A;570:       <span class="ruby-ivar">@rye_safe</span> = <span class="ruby-identifier">previous_state</span>&#x000A;571:       <span class="ruby-identifier">ret</span>&#x000A;572:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000146'>
                <a name='M000146'>      </a>
                <div class='synopsis'>
                  <span class='name'>setenv</span>
                  <span class='arguments'>(n, v)</span>
                </div>
                <div class='description'>
                  <p>
                  Add an environment variable. <tt>n</tt> and <tt>v</tt> are the name and
                  value. Returns the instance of <a href="Box.html">Rye::Box</a>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000146-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000146-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 296</span>&#x000A;296:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">setenv</span>(<span class="ruby-identifier">n</span>, <span class="ruby-identifier">v</span>)&#x000A;297:       <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Adding env: #{n}=#{v}&quot;</span>&#x000A;298:       <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;prev value: #{@rye_getenv[n]}&quot;</span>&#x000A;299:       <span class="ruby-ivar">@rye_getenv</span>[<span class="ruby-identifier">n</span>] = <span class="ruby-identifier">v</span>&#x000A;300:       (<span class="ruby-ivar">@rye_current_environment_variables</span> <span class="ruby-operator">||=</span> {})[<span class="ruby-identifier">n</span>] = <span class="ruby-identifier">v</span>&#x000A;301:       <span class="ruby-keyword kw">self</span>&#x000A;302:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000135'>
                <a name='M000135'>      </a>
                <div class='synopsis'>
                  <span class='name'>ssh_config_options</span>
                  <span class='arguments'>(host)</span>
                </div>
                <div class='description'>
                  <p>
                  Parse SSH config files for use with Net::SSH
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000135-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000135-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 152</span>&#x000A;152:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ssh_config_options</span>(<span class="ruby-identifier">host</span>)&#x000A;153:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Config</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">host</span>)&#x000A;154:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000112'>
                <a name='M000112'>      </a>
                <div class='synopsis'>
                  <span class='name'>stash</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns the current value of the stash +@rye_stash+
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000112-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000112-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 38</span>&#x000A;38:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stash</span>; <span class="ruby-ivar">@rye_stash</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000117'>
                <a name='M000117'>      </a>
                <div class='synopsis'>
                  <span class='name'>stash=</span>
                  <span class='arguments'>(val)</span>
                </div>
                <div class='description'>
                  <p>
                  Store a value to the stash +@rye_stash+
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000117-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000117-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 46</span>&#x000A;46:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stash=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_stash</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000139'>
                <a name='M000139'>      </a>
                <div class='synopsis'>
                  <span class='name'>switch_user</span>
                  <span class='arguments'>(newuser)</span>
                </div>
                <div class='description'>
                  <p>
                  Reconnect as another user. This is different from su= which executes
                  subsequent commands via +su -c COMMAND USER+.
                  </p>
                  <ul>
                  <li><tt>newuser</tt> The username to reconnect as
                  
                  </li>
                  </ul>
                  <p>
                  NOTE: if there is an open connection, it&#8217;s disconnected but not
                  reconnected because it&#8217;s possible it wasn&#8217;t connected yet in
                  the first place (if you create the instance with default settings for
                  example)
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000139-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000139-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 212</span>&#x000A;212:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">switch_user</span>(<span class="ruby-identifier">newuser</span>)&#x000A;213:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">newuser</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">to_s</span>&#x000A;214:       <span class="ruby-ivar">@rye_opts</span> <span class="ruby-operator">||=</span> {}&#x000A;215:       <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">newuser</span>&#x000A;216:       <span class="ruby-identifier">disconnect</span>&#x000A;217:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000149'>
                <a name='M000149'>      </a>
                <div class='synopsis'>
                  <span class='name'>to_s</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns +user@rye_host+
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000149-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000149-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 309</span>&#x000A;309:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>; <span class="ruby-value str">'%s@rye_%s'</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">user</span>, <span class="ruby-ivar">@rye_host</span>]; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000138'>
                <a name='M000138'>      </a>
                <div class='synopsis'>
                  <span class='name'>umask=</span>
                  <span class='arguments'>(val='0022')</span>
                </div>
                <div class='description'>
                  <p>
                  Change the current umask (sort of &#8212; works the same way as cd) The
                  default umask is 0022
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000138-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000138-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 198</span>&#x000A;198:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">umask=</span>(<span class="ruby-identifier">val</span>=<span class="ruby-value str">'0022'</span>)&#x000A;199:       <span class="ruby-ivar">@rye_current_umask</span> = <span class="ruby-identifier">val</span>&#x000A;200:       <span class="ruby-keyword kw">self</span>&#x000A;201:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000162'>
                <a name='M000162'>      </a>
                <div class='synopsis'>
                  <span class='name'>unsafely</span>
                  <span class='arguments'>(*args, &amp;block)</span>
                </div>
                <div class='description'>
                  <p>
                  Like batch, except it disables safe mode before executing the block. After
                  executing the block, safe mode is returned back to whichever state it was
                  previously in. In other words, this method won&#8217;t enable safe mode if
                  it was already disabled.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000162-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000162-source'>     <span class="ruby-comment cmt"># File lib/rye/box.rb, line 557</span>&#x000A;557:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unsafely</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;558:       <span class="ruby-identifier">previous_state</span> = <span class="ruby-ivar">@rye_safe</span>&#x000A;559:       <span class="ruby-identifier">disable_safe_mode</span>&#x000A;560:       <span class="ruby-identifier">ret</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_exec</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>&#x000A;561:       <span class="ruby-ivar">@rye_safe</span> = <span class="ruby-identifier">previous_state</span>&#x000A;562:       <span class="ruby-identifier">ret</span>&#x000A;563:     <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000111'>
                <a name='M000111'>      </a>
                <div class='synopsis'>
                  <span class='name'>user</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000111-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000111-source'>    <span class="ruby-comment cmt"># File lib/rye/box.rb, line 35</span>&#x000A;35:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">user</span>; <span class="ruby-ivar">@rye_user</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
