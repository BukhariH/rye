<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Rye [Rye: Safely run SSH commands on a bunch of machines at the same time (from Ruby).]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <div class='name'>
          <span class='type'>Module</span>
          Rye
        </div>
        <ol class='paths'>
          <li>
            <a href="../files/lib/rye/box_rb.html">lib/rye/box.rb</a>
          </li>
          <li class='other'>
            <a href="../files/lib/rye/cmd_rb.html">lib/rye/cmd.rb</a>
          </li>
          <li class='other'>
            <a href="../files/lib/rye/key_rb.html">lib/rye/key.rb</a>
          </li>
          <li class='other'>
            <a href="../files/lib/rye/set_rb.html">lib/rye/set.rb</a>
          </li>
          <li class='other'>
            <a href="../files/lib/rye/rap_rb.html">lib/rye/rap.rb</a>
          </li>
          <li class='other'>
            <a href="../files/lib/rye_rb.html">lib/rye.rb</a>
          </li>
          <li>
            <a class='show' href='#' onclick='this.parentNode.parentNode.className += " expanded"; this.parentNode.removeChild(this); return false'>show all</a>
          </li>
        </ol>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <h1><a href="Rye.html">Rye</a></h1>
            <p>
            Safely run remote commands via SSH in Ruby.
            </p>
            <p>
            <a href="Rye.html">Rye</a> is similar to <a
            href="http://rush.heroku.com">Rush</a> but everything happens over SSH (no
            HTTP daemon) and the default settings are less dangerous (for safety). For
            example, file globs and the &#8220;rm&#8221; command are disabled so unless
            otherwise specified, you can&#8217;t do this:
            <tt>rbox.rm('/etc/*<b>/</b>')</tt>.
            </p>
            <p>
            However, you can do this:
            </p>
            <p>
            rset = <a
            href="Rye/Set.html#M000173">Rye::Set.new</a>(&#8220;dev-machines&#8221;)
            rset.add_boxes(&#8216;host1&#8217;, &#8216;host2&#8217;,
            &#8216;host3&#8217;, &#8216;host4&#8217;) rset.ps(&#8216;aux&#8217;)
            </p>
            <ul>
            <li>See <tt><a href="../files/bin/try.html">bin/try</a></tt> for a bunch of
            working examples.
            
            </li>
            <li>See Rye::Box#initialize for info about disabling safe-mode.
            
            </li>
            </ul>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000001">sysinfo</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000006">add_keys</a></li>
              <li><a href="#M000012">escape</a></li>
              <li><a href="#M000005">find_private_keys</a></li>
              <li><a href="#M000007">keys</a></li>
              <li><a href="#M000004">mutex</a></li>
              <li><a href="#M000009">prepare_command</a></li>
              <li><a href="#M000003">reload</a></li>
              <li><a href="#M000008">remote_host_keys</a></li>
              <li><a href="#M000011">shell</a></li>
              <li><a href="#M000013">sshagent_info</a></li>
              <li><a href="#M000015">strand</a></li>
              <li><a href="#M000002">sysinfo</a></li>
              <li><a href="#M000010">which</a></li>
              <li><a href="#M000014">without_indent</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Module <a href="Rye/Cmd.html" class="link">Rye::Cmd</a><br />
              Class <a href="Rye/Box.html" class="link">Rye::Box</a><br />
              Class <a href="Rye/CommandError.html" class="link">Rye::CommandError</a><br />
              Class <a href="Rye/CommandNotFound.html" class="link">Rye::CommandNotFound</a><br />
              Class <a href="Rye/Key.html" class="link">Rye::Key</a><br />
              Class <a href="Rye/NoBoxes.html" class="link">Rye::NoBoxes</a><br />
              Class <a href="Rye/NoHost.html" class="link">Rye::NoHost</a><br />
              Class <a href="Rye/NoPassword.html" class="link">Rye::NoPassword</a><br />
              Class <a href="Rye/NoPty.html" class="link">Rye::NoPty</a><br />
              Class <a href="Rye/NotConnected.html" class="link">Rye::NotConnected</a><br />
              Class <a href="Rye/Rap.html" class="link">Rye::Rap</a><br />
              Class <a href="Rye/RyeError.html" class="link">Rye::RyeError</a><br />
              Class <a href="Rye/Set.html" class="link">Rye::Set</a><br />
            </div>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>VERSION</td>
                    <td>=</td>
                    <td class='context-item-value'>&quot;0.8.2&quot;.freeze</td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>SYSINFO</td>
                    <td>=</td>
                    <td class='context-item-value'>SysInfo.new.freeze</td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='public-class method' id='method-M000001'>
                <a name='M000001'>      </a>
                <div class='synopsis'>
                  <span class='name'>sysinfo</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Accessor for an instance of SystemInfo
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000001-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000001-source'>    <span class="ruby-comment cmt"># File lib/rye.rb, line 54</span>&#x000A;54:   <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>; <span class="ruby-constant">SYSINFO</span>; <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000006'>
                <a name='M000006'>      </a>
                <div class='synopsis'>
                  <span class='name'>add_keys</span>
                  <span class='arguments'>(*keys)</span>
                </div>
                <div class='description'>
                  <p>
                  Add one or more private keys to the SSH Agent.
                  </p>
                  <ul>
                  <li><tt>keys</tt> one or more file paths to private keys used for passwordless
                  logins.
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000006-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000006-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 122</span>&#x000A;122:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_keys</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">keys</span>)&#x000A;123:     <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span> <span class="ruby-operator">||</span> []&#x000A;124:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">empty?</span>&#x000A;125:     <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">shell</span>(<span class="ruby-value str">&quot;ssh-add&quot;</span>, <span class="ruby-identifier">keys</span>)&#x000A;126:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000012'>
                <a name='M000012'>      </a>
                <div class='synopsis'>
                  <span class='name'>escape</span>
                  <span class='arguments'>(safe, cmd, *args)</span>
                </div>
                <div class='description'>
                  <p>
                  Creates a string from <tt>cmd</tt> and <tt>args</tt>. If <tt>safe</tt> is
                  true it will send them through Escape.shell_command otherwise it will
                  return them joined by a space character.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000012-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000012-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 231</span>&#x000A;231:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">escape</span>(<span class="ruby-identifier">safe</span>, <span class="ruby-identifier">cmd</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;232:     <span class="ruby-identifier">args</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span> <span class="ruby-operator">||</span> []&#x000A;233:     <span class="ruby-identifier">safe</span> <span class="ruby-value">? </span><span class="ruby-constant">Escape</span>.<span class="ruby-identifier">shell_command</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>).<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> [<span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">args</span>].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>)&#x000A;234:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000005'>
                <a name='M000005'>      </a>
                <div class='synopsis'>
                  <span class='name'>find_private_keys</span>
                  <span class='arguments'>(path)</span>
                </div>
                <div class='description'>
                  <p>
                  Looks for private keys in <tt>path</tt> and returns and Array of paths to
                  the files it fines. Raises an Exception if path does not exist. If path is
                  a file rather than a directory, it will check whether that single file is a
                  private key.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000005-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000005-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 99</span>&#x000A; 99:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_private_keys</span>(<span class="ruby-identifier">path</span>)&#x000A;100:     <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;#{path} does not exist&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>)&#x000A;101:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">path</span>)&#x000A;102:       <span class="ruby-identifier">files</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">entries</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">file</span>) }&#x000A;103:     <span class="ruby-keyword kw">else</span>&#x000A;104:       <span class="ruby-identifier">files</span> = [<span class="ruby-identifier">path</span>]&#x000A;105:     <span class="ruby-keyword kw">end</span>&#x000A;106:     &#x000A;107:     <span class="ruby-identifier">files</span> = <span class="ruby-identifier">files</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>&#x000A;108:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">file</span>)&#x000A;109:       <span class="ruby-identifier">pk</span> = <span class="ruby-keyword kw">nil</span>&#x000A;110:       <span class="ruby-keyword kw">begin</span>&#x000A;111:         <span class="ruby-identifier">tmp</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Key</span>.<span class="ruby-identifier">from_file</span>(<span class="ruby-identifier">file</span>) &#x000A;112:         <span class="ruby-identifier">pk</span> = <span class="ruby-identifier">tmp</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">private?</span>&#x000A;113:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">PKeyError</span>&#x000A;114:       <span class="ruby-keyword kw">end</span>&#x000A;115:       <span class="ruby-operator">!</span><span class="ruby-identifier">pk</span>.<span class="ruby-identifier">nil?</span>&#x000A;116:     <span class="ruby-keyword kw">end</span>&#x000A;117:     <span class="ruby-identifier">files</span> <span class="ruby-operator">||</span> []&#x000A;118:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000007'>
                <a name='M000007'>      </a>
                <div class='synopsis'>
                  <span class='name'>keys</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns an Array of info about the currently available SSH keys, as
                  provided by the SSH Agent. See Rye.start_sshagent_environment
                  </p>
                  <p>
                  Returns: [[bits, finger-print, file-path], &#8230;]
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000007-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000007-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 134</span>&#x000A;134:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">keys</span>&#x000A;135:     <span class="ruby-comment cmt"># 2048 76:cb:d7:82:90:92:ad:75:3d:68:6c:a9:21:ca:7b:7f /Users/rye/.ssh/id_rsa (RSA)</span>&#x000A;136:     <span class="ruby-comment cmt"># 2048 7b:a6:ba:55:b1:10:1d:91:9f:73:3a:aa:0c:d4:88:0e /Users/rye/.ssh/id_dsa (DSA)</span>&#x000A;137:     <span class="ruby-identifier">keystr</span> = <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">shell</span>(<span class="ruby-value str">&quot;ssh-add&quot;</span>, <span class="ruby-value str">'-l'</span>)&#x000A;138:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">keystr</span>&#x000A;139:     <span class="ruby-identifier">keystr</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>&#x000A;140:       <span class="ruby-identifier">key</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\s+/</span>)&#x000A;141:     <span class="ruby-keyword kw">end</span>&#x000A;142:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000004'>
                <a name='M000004'>      </a>
                <div class='synopsis'>
                  <span class='name'>mutex</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000004-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000004-source'>    <span class="ruby-comment cmt"># File lib/rye.rb, line 91</span>&#x000A;91:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">mutex</span>&#x000A;92:     <span class="ruby-ivar">@@mutex</span>&#x000A;93:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000009'>
                <a name='M000009'>      </a>
                <div class='synopsis'>
                  <span class='name'>prepare_command</span>
                  <span class='arguments'>(cmd, *args)</span>
                </div>
                <div class='description'>
                  <p>
                  Takes a command with arguments and returns it in a single String with
                  escaped args and some other stuff.
                  </p>
                  <ul>
                  <li><tt>cmd</tt> The shell command name or absolute path.
                  
                  </li>
                  <li><tt>args</tt> an Array of command arguments.
                  
                  </li>
                  </ul>
                  <p>
                  The command is searched for in the local PATH (where <a
                  href="Rye.html">Rye</a> is running). An exception is raised if it&#8217;s
                  not found. NOTE: Because this happens locally, you won&#8217;t want to use
                  this method if the environment is quite different from the remote machine
                  it will be executed on.
                  </p>
                  <p>
                  The command arguments are passed through Escape.shell_command (that means
                  you can&#8217;t use environment variables or asterisks).
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000009-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000009-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 166</span>&#x000A;166:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare_command</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;167:     <span class="ruby-identifier">args</span> <span class="ruby-operator">&amp;&amp;=</span> [<span class="ruby-identifier">args</span>].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;168:     <span class="ruby-identifier">cmd</span> = <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">which</span>(<span class="ruby-identifier">cmd</span>)&#x000A;169:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">CommandNotFound</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">cmd</span> <span class="ruby-operator">||</span> <span class="ruby-value str">'nil'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">cmd</span>&#x000A;170:     <span class="ruby-comment cmt"># Symbols to switches. :l -&gt; -l, :help -&gt; --help</span>&#x000A;171:     <span class="ruby-identifier">args</span>.<span class="ruby-identifier">collect!</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span>&#x000A;172:       <span class="ruby-identifier">a</span> = <span class="ruby-node">&quot;-#{a}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>&#x000A;173:       <span class="ruby-identifier">a</span> = <span class="ruby-node">&quot;--#{a}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)&#x000A;174:       <span class="ruby-identifier">a</span>&#x000A;175:     <span class="ruby-keyword kw">end</span>&#x000A;176:     <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-ivar">@safe</span>, <span class="ruby-identifier">cmd</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;177:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000003'>
                <a name='M000003'>      </a>
                <div class='synopsis'>
                  <span class='name'>reload</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Reload <a href="Rye.html">Rye</a> dynamically. Useful with irb. NOTE: does
                  not reload rye.rb.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000003-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000003-source'>    <span class="ruby-comment cmt"># File lib/rye.rb, line 86</span>&#x000A;86:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reload</span>&#x000A;87:     <span class="ruby-identifier">pat</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword kw">__FILE__</span>), <span class="ruby-value str">'rye'</span>)&#x000A;88:     <span class="ruby-node">%w{key rap cmd box set}</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">lib</span><span class="ruby-operator">|</span> <span class="ruby-identifier">load</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">pat</span>, <span class="ruby-node">&quot;#{lib}.rb&quot;</span>) }&#x000A;89:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000008'>
                <a name='M000008'>      </a>
                <div class='synopsis'>
                  <span class='name'>remote_host_keys</span>
                  <span class='arguments'>(*hostnames)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000008-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000008-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 144</span>&#x000A;144:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remote_host_keys</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">hostnames</span>)&#x000A;145:     <span class="ruby-identifier">hostnames</span> = <span class="ruby-identifier">hostnames</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span> <span class="ruby-operator">||</span> []&#x000A;146:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hostnames</span>.<span class="ruby-identifier">empty?</span>&#x000A;147:     <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">shell</span>(<span class="ruby-value str">&quot;ssh-keyscan&quot;</span>, <span class="ruby-identifier">hostnames</span>)&#x000A;148:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000011'>
                <a name='M000011'>      </a>
                <div class='synopsis'>
                  <span class='name'>shell</span>
                  <span class='arguments'>(cmd, *args)</span>
                </div>
                <div class='description'>
                  <p>
                  Execute a local system command (via the shell, not SSH)
                  </p>
                  <ul>
                  <li><tt>cmd</tt> the executable path (relative or absolute)
                  
                  </li>
                  <li><tt>args</tt> Array of arguments to be sent to the command. Each element
                  
                  </li>
                  </ul>
                  <p>
                  is one argument:. i.e. <tt>['-l', 'some/path']</tt>
                  </p>
                  <p>
                  NOTE: shell is a bit paranoid so it escapes every argument. This means you
                  can only use literal values. That means no asterisks too.
                  </p>
                  <p>
                  Returns a <a href="Rye/Rap.html">Rye::Rap</a> object.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000011-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000011-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 206</span>&#x000A;206:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">shell</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;207:     <span class="ruby-identifier">args</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>&#x000A;208:     <span class="ruby-identifier">cmd</span> = <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)&#x000A;209:     <span class="ruby-comment cmt"># TODO: allow stdin to be sent to the cmd</span>&#x000A;210:     <span class="ruby-identifier">tf</span> = <span class="ruby-constant">Tempfile</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">cmd</span>)&#x000A;211:     <span class="ruby-identifier">cmd</span> = <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">prepare_command</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-identifier">args</span>)&#x000A;212:     <span class="ruby-identifier">cmd</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; 2&gt;#{tf.path}&quot;</span> <span class="ruby-comment cmt"># Redirect STDERR to file. Works in DOS too.</span>&#x000A;213:     <span class="ruby-comment cmt"># Deal with STDOUT</span>&#x000A;214:     <span class="ruby-identifier">handle</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-identifier">cmd</span>, <span class="ruby-value str">&quot;r&quot;</span>)&#x000A;215:     <span class="ruby-identifier">stdout</span> = <span class="ruby-identifier">handle</span>.<span class="ruby-identifier">read</span>.<span class="ruby-identifier">chomp</span>&#x000A;216:     <span class="ruby-identifier">handle</span>.<span class="ruby-identifier">close</span>&#x000A;217:     <span class="ruby-comment cmt"># Then STDERR</span>&#x000A;218:     <span class="ruby-identifier">stderr</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">tf</span>.<span class="ruby-identifier">path</span>) <span class="ruby-operator">?</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">tf</span>.<span class="ruby-identifier">path</span>) <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>&#x000A;219:     <span class="ruby-identifier">tf</span>.<span class="ruby-identifier">delete</span>&#x000A;220:     <span class="ruby-comment cmt"># Create the response object</span>&#x000A;221:     <span class="ruby-identifier">rap</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Rap</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>)&#x000A;222:     <span class="ruby-identifier">rap</span>.<span class="ruby-identifier">add_stdout</span>(<span class="ruby-identifier">stdout</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>)&#x000A;223:     <span class="ruby-identifier">rap</span>.<span class="ruby-identifier">add_stderr</span>(<span class="ruby-identifier">stderr</span> <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>)&#x000A;224:     <span class="ruby-identifier">rap</span>.<span class="ruby-identifier">add_exit_code</span>(<span class="ruby-identifier">$?</span>)&#x000A;225:     <span class="ruby-identifier">rap</span>&#x000A;226:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000013'>
                <a name='M000013'>      </a>
                <div class='synopsis'>
                  <span class='name'>sshagent_info</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000013-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000013-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 236</span>&#x000A;236:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sshagent_info</span>&#x000A;237:     <span class="ruby-ivar">@@agent_env</span>&#x000A;238:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000015'>
                <a name='M000015'>      </a>
                <div class='synopsis'>
                  <span class='name'>strand</span>
                  <span class='arguments'>( len=8, safe=true )</span>
                </div>
                <div class='description'>
                  <p>
                  Generates a string of random alphanumeric characters.
                  </p>
                  <ul>
                  <li><tt>len</tt> is the length, an Integer. Default: 8
                  
                  </li>
                  <li><tt>safe</tt> in safe-mode, ambiguous characters are removed (default:
                  true):
                  
                  <pre>i l o 1 0</pre>
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000015-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000015-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 252</span>&#x000A;252:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">strand</span>( <span class="ruby-identifier">len</span>=<span class="ruby-value">8</span>, <span class="ruby-identifier">safe</span>=<span class="ruby-keyword kw">true</span> )&#x000A;253:      <span class="ruby-identifier">chars</span> = (<span class="ruby-value str">&quot;a&quot;</span><span class="ruby-operator">..</span><span class="ruby-value str">&quot;z&quot;</span>).<span class="ruby-identifier">to_a</span> <span class="ruby-operator">+</span> (<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">..</span><span class="ruby-value str">&quot;9&quot;</span>).<span class="ruby-identifier">to_a</span>&#x000A;254:      <span class="ruby-identifier">chars</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-node">%w(i l o 1 0)</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">v</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">safe</span>&#x000A;255:      <span class="ruby-identifier">str</span> = <span class="ruby-value str">&quot;&quot;</span>&#x000A;256:      <span class="ruby-value">1</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-identifier">len</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">chars</span>[<span class="ruby-identifier">rand</span>(<span class="ruby-identifier">chars</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>)] }&#x000A;257:      <span class="ruby-identifier">str</span>&#x000A;258:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000002'>
                <a name='M000002'>      </a>
                <div class='synopsis'>
                  <span class='name'>sysinfo</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Accessor for an instance of SystemInfo
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000002-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000002-source'>    <span class="ruby-comment cmt"># File lib/rye.rb, line 57</span>&#x000A;57:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sysinfo</span>; <span class="ruby-constant">SYSINFO</span>;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000010'>
                <a name='M000010'>      </a>
                <div class='synopsis'>
                  <span class='name'>which</span>
                  <span class='arguments'>(executable)</span>
                </div>
                <div class='description'>
                  <p>
                  An all ruby implementation of unix &#8220;which&#8221; command.
                  </p>
                  <ul>
                  <li><tt>executable</tt> the name of the executable
                  
                  </li>
                  </ul>
                  <p>
                  Returns the absolute path if found in PATH otherwise nil.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000010-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000010-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 184</span>&#x000A;184:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">which</span>(<span class="ruby-identifier">executable</span>)&#x000A;185:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">executable</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)&#x000A;186:     <span class="ruby-comment cmt">#return executable if File.exists?(executable) # SHOULD WORK, MUST TEST</span>&#x000A;187:     <span class="ruby-identifier">shortname</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">executable</span>)&#x000A;188:     <span class="ruby-identifier">dir</span> = <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>.<span class="ruby-identifier">paths</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>    <span class="ruby-comment cmt"># dir contains all of the </span>&#x000A;189:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span> <span class="ruby-identifier">path</span>             <span class="ruby-comment cmt"># occurrences of shortname  </span>&#x000A;190:       <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">entries</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">shortname</span>)  <span class="ruby-comment cmt"># found in the paths. </span>&#x000A;191:     <span class="ruby-keyword kw">end</span>&#x000A;192:     <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>.<span class="ruby-identifier">first</span>, <span class="ruby-identifier">shortname</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Return just the first</span>&#x000A;193:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000014'>
                <a name='M000014'>      </a>
                <div class='synopsis'>
                  <span class='name'>without_indent</span>
                  <span class='arguments'>(str)</span>
                </div>
                <div class='description'>
                  <p>
                  Returns <tt>str</tt> with the leading indentation removed. Stolen from <a
                  href="http://github.com/mynyml/unindent/">github.com/mynyml/unindent/</a>
                  because it was better.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000014-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000014-source'>     <span class="ruby-comment cmt"># File lib/rye.rb, line 242</span>&#x000A;242:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">without_indent</span>(<span class="ruby-identifier">str</span>)&#x000A;243:     <span class="ruby-identifier">indent</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">split</span>(<span class="ruby-identifier">$/</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">line</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span> }.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">index</span>(<span class="ruby-regexp re">/[^\s]/</span>) }.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">min</span>&#x000A;244:     <span class="ruby-identifier">str</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-node">/^[[:blank:]]{#{indent}}/</span>, <span class="ruby-value str">''</span>)&#x000A;245:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
