<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

  <title>Class: Rye::Hop</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/rye/hop_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/rye/hop.rb">lib/rye/hop.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-3D-3D">#==</a></li>
          
          <li><a href="#method-i-add_key">#add_key</a></li>
          
          <li><a href="#method-i-add_keys">#add_keys</a></li>
          
          <li><a href="#method-i-connect">#connect</a></li>
          
          <li><a href="#method-i-debug-3F">#debug?</a></li>
          
          <li><a href="#method-i-disconnect">#disconnect</a></li>
          
          <li><a href="#method-i-error-3F">#error?</a></li>
          
          <li><a href="#method-i-exception_hook-3D">#exception_hook=</a></li>
          
          <li><a href="#method-i-fetch_port">#fetch_port</a></li>
          
          <li><a href="#method-i-host">#host</a></li>
          
          <li><a href="#method-i-host-3D">#host=</a></li>
          
          <li><a href="#method-i-host_key">#host_key</a></li>
          
          <li><a href="#method-i-info-3F">#info?</a></li>
          
          <li><a href="#method-i-inspect">#inspect</a></li>
          
          <li><a href="#method-i-keys">#keys</a></li>
          
          <li><a href="#method-i-nickname">#nickname</a></li>
          
          <li><a href="#method-i-nickname-3D">#nickname=</a></li>
          
          <li><a href="#method-i-opts">#opts</a></li>
          
          <li><a href="#method-i-opts-3D">#opts=</a></li>
          
          <li><a href="#method-i-remove_hops-21">#remove_hops!</a></li>
          
          <li><a href="#method-i-remove_key">#remove_key</a></li>
          
          <li><a href="#method-i-remove_keys">#remove_keys</a></li>
          
          <li><a href="#method-i-root-3F">#root?</a></li>
          
          <li><a href="#method-i-ssh_config_options">#ssh_config_options</a></li>
          
          <li><a href="#method-i-switch_user">#switch_user</a></li>
          
          <li><a href="#method-i-to_s">#to_s</a></li>
          
          <li><a href="#method-i-user">#user</a></li>
          
          <li><a href="#method-i-via">#via</a></li>
          
          <li><a href="#method-i-via-3F">#via?</a></li>
          
          <li><a href="#method-i-via_hop">#via_hop</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../CHANGES_txt.html">CHANGES.txt</a></li>
        
          <li class="file"><a href="../LICENSE_txt.html">LICENSE.txt</a></li>
        
          <li class="file"><a href="../README_rdoc.html">README.rdoc</a></li>
        
          <li class="file"><a href="../bin/try.html">try</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Rye.html">Rye</a></li>
        
          <li><a href="../Rye/Box.html">Rye::Box</a></li>
        
          <li><a href="../Rye/Box/InstanceExecHelper.html">Rye::Box::InstanceExecHelper</a></li>
        
          <li><a href="../Rye/Cmd.html">Rye::Cmd</a></li>
        
          <li><a href="../Rye/CommandNotFound.html">Rye::CommandNotFound</a></li>
        
          <li><a href="../Rye/Err.html">Rye::Err</a></li>
        
          <li><a href="../Rye/Hop.html">Rye::Hop</a></li>
        
          <li><a href="../Rye/Key.html">Rye::Key</a></li>
        
          <li><a href="../Rye/Key/BadFile.html">Rye::Key::BadFile</a></li>
        
          <li><a href="../Rye/Key/BadPerm.html">Rye::Key::BadPerm</a></li>
        
          <li><a href="../Rye/NoBoxes.html">Rye::NoBoxes</a></li>
        
          <li><a href="../Rye/NoHost.html">Rye::NoHost</a></li>
        
          <li><a href="../Rye/NoPassword.html">Rye::NoPassword</a></li>
        
          <li><a href="../Rye/NoPty.html">Rye::NoPty</a></li>
        
          <li><a href="../Rye/NotConnected.html">Rye::NotConnected</a></li>
        
          <li><a href="../Rye/Rap.html">Rye::Rap</a></li>
        
          <li><a href="../Rye/RyeError.html">Rye::RyeError</a></li>
        
          <li><a href="../Rye/Set.html">Rye::Set</a></li>
        
          <li><a href="../Rye/Tpl.html">Rye::Tpl</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Rye::Hop</h1>

    <div id="description" class="description">
      
<h1><a href="Hop.html">Rye::Hop</a></h1>

<p>The <a href="Hop.html">Rye::Hop</a> class represents a machine.  This class
allows boxes to by accessed <a href="Hop.html#method-i-via">via</a> it.</p>

<pre>rhop = Rye::Hop.new('firewall.lan')
rbox = Rye::Box.new('filibuster', :via =&gt; rhop)
rbox.uptime     # =&gt; 20:53  up 1 day,  1:52, 4 users</pre>

<p>Or</p>

<pre>rbox = Rye::Box.new('filibuster', :via =&gt; 'firewall.lan')</pre>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="MAX_PORT">MAX_PORT</a></dt>
          
          <dd class="description"><p>The maximum port number that the gateway will attempt to use to forward
connections from.</p></dd>
          
        
          <dt><a name="MIN_PORT">MIN_PORT</a></dt>
          
          <dd class="description"><p>The minimum port number that the gateway will attempt to use to forward
connections from.</p></dd>
          
        
        </dl>
      </div>
      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(host, opts={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <ul><li>
<p><tt>host</tt> The hostname to <a
href="Hop.html#method-i-connect">connect</a> to. Default: localhost.</p>
</li><li>
<p><tt>user</tt> The username to <a
href="Hop.html#method-i-connect">connect</a> as. Default: SSH config file
or current shell <a href="Hop.html#method-i-user">user</a>.</p>
</li><li>
<p><tt>opts</tt> a hash of optional arguments.</p>
</li></ul>

<p>The <tt>opts</tt> hash excepts the following <a
href="Hop.html#method-i-keys">keys</a>:</p>
<ul><li>
<p>:port =&gt; remote server ssh port. Default: SSH config file or 22</p>
</li><li>
<p>:<a href="Hop.html#method-i-keys">keys</a> =&gt; one or more private key
file paths (passwordless login)</p>
</li><li>
<p>:<a href="Hop.html#method-i-via">via</a> =&gt; the <a
href="Hop.html">Rye::Hop</a> to access this <a
href="Hop.html#method-i-host">host</a> through</p>
</li><li>
<p>:info =&gt; an IO object to print <a href="Box.html">Rye::Box</a> command
info to. Default: nil</p>
</li><li>
<p>:debug =&gt; an IO object to print <a href="Box.html">Rye::Box</a>
debugging info to. Default: nil</p>
</li><li>
<p>:error =&gt; an IO object to print <a href="Box.html">Rye::Box</a> errors
to. Default: STDERR</p>
</li><li>
<p>:getenv =&gt; pre-fetch <tt>host</tt> environment variables? (default:
true)</p>
</li><li>
<p>:password =&gt; the <a href="Hop.html#method-i-user">user</a>'s password
(ignored if there's a valid private key)</p>
</li><li>
<p>:templates =&gt; the template engine to use for uploaded files. One of:
:erb (default)</p>
</li><li>
<p>:sudo =&gt; Run all commands <a href="Hop.html#method-i-via">via</a> sudo
(default: false)</p>
</li></ul>

<p>NOTE: <tt>opts</tt> can also contain any parameter supported by 
Net::SSH.start that is not already mentioned above.</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">opts</span>={})
  <span class="ruby-identifier">ssh_opts</span> = <span class="ruby-identifier">ssh_config_options</span>(<span class="ruby-identifier">host</span>)
  <span class="ruby-ivar">@rye_exception_hook</span> = {}
  <span class="ruby-ivar">@rye_host</span> = <span class="ruby-identifier">host</span>
  
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:user</span>]
    <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:user</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">ssh_opts</span>[<span class="ruby-value">:user</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">sysinfo</span>.<span class="ruby-identifier">user</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-comment"># These opts are use by Rye::Box and also passed to</span>
  <span class="ruby-comment"># Net::SSH::Gateway (and Net::SSH)</span>
  <span class="ruby-ivar">@rye_opts</span> = {
    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ssh_opts</span>[<span class="ruby-value">:port</span>],
    <span class="ruby-value">:keys</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>,
    <span class="ruby-value">:via</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:info</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:debug</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">STDERR</span>,
    <span class="ruby-value">:getenv</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>,
    <span class="ruby-value">:templates</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:erb</span>,
    <span class="ruby-value">:quiet</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>
  }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)

  <span class="ruby-ivar">@next_port</span> = <span class="ruby-constant">MAX_PORT</span>

  <span class="ruby-comment"># Close the SSH session before Ruby exits. This will do nothing</span>
  <span class="ruby-comment"># if disconnect has already been called explicitly. </span>
  <span class="ruby-identifier">at_exit</span> { <span class="ruby-keyword">self</span>.<span class="ruby-identifier">disconnect</span> }

  <span class="ruby-comment"># Properly handle whether the opt :via is a +Rye::Hop+ or a +String+</span>
  <span class="ruby-comment"># and does nothing if nil</span>
  <span class="ruby-identifier">via_hop</span>(<span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:via</span>))

  <span class="ruby-comment"># @rye_opts gets sent to Net::SSH so we need to remove the keys</span>
  <span class="ruby-comment"># that are not meant for it. </span>
  <span class="ruby-ivar">@rye_safe</span>, <span class="ruby-ivar">@rye_debug</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:safe</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:debug</span>)
  <span class="ruby-ivar">@rye_info</span>, <span class="ruby-ivar">@rye_error</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:info</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:error</span>)
  <span class="ruby-ivar">@rye_getenv</span> = {} <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:getenv</span>) <span class="ruby-comment"># Enable getenv with a hash</span>
  <span class="ruby-ivar">@rye_ostype</span>, <span class="ruby-ivar">@rye_impltype</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:ostype</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:impltype</span>)
  <span class="ruby-ivar">@rye_quiet</span>, <span class="ruby-ivar">@rye_sudo</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:quiet</span>), <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:sudo</span>)
  <span class="ruby-ivar">@rye_templates</span> = <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:templates</span>)
  
  <span class="ruby-comment"># Store the state of the terminal </span>
  <span class="ruby-ivar">@rye_stty_save</span> = <span class="ruby-value">`stty -g`</span>.<span class="ruby-identifier">chomp</span> <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>
  
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_templates</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">require</span> <span class="ruby-ivar">@rye_templates</span>.<span class="ruby-identifier">to_s</span>   <span class="ruby-comment"># should be :erb</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:logger</span>] = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@rye_debug</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_debug</span> <span class="ruby-comment"># Enable Net::SSH debugging</span>
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] = [<span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>]].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>
  
  <span class="ruby-comment"># Just in case someone sends a true value rather than IO object</span>
  <span class="ruby-ivar">@rye_debug</span> = <span class="ruby-constant">STDERR</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_debug</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">||</span> <span class="ruby-constant">DEBUG</span>
  <span class="ruby-ivar">@rye_error</span> = <span class="ruby-constant">STDERR</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_error</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@rye_info</span> = <span class="ruby-constant">STDOUT</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
  
  <span class="ruby-comment"># Add the given private keys to the keychain that will be used for @rye_host</span>
  <span class="ruby-identifier">add_keys</span>(<span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>])
  
  <span class="ruby-comment"># From: capistrano/lib/capistrano/cli.rb</span>
  <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword">true</span> <span class="ruby-comment"># so that Net::SSH prompts show up</span>
  
  <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;ssh-agent info: #{Rye.sshagent_info.inspect}&quot;</span>
  <span class="ruby-identifier">debug</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="3D-3D-method" class="method-detail ">
          <a name="method-i-3D-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">==</span><span
              class="method-args">(other)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Compares itself with the <tt>other</tt> box. If the hostnames are the same,
this will return true. Otherwise false.</p>
            

            
            <div class="method-source-code" id="3D-3D-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 361</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@rye_host</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">host</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- 3D-3D-source -->
            
          </div>

          

          
        </div><!-- 3D-3D-method -->

      
        <div id="add_key-method" class="method-detail method-alias">
          <a name="method-i-add_key"></a>

          
          <div class="method-heading">
            <span class="method-name">add_key</span><span
              class="method-args">(*keys)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="Hop.html#method-i-add_keys">add_keys</a>
          </div>
          
        </div><!-- add_key-method -->

      
        <div id="add_keys-method" class="method-detail ">
          <a name="method-i-add_keys"></a>

          
          <div class="method-heading">
            <span class="method-name">add_keys</span><span
              class="method-args">(*keys)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Add one or more private <a href="Hop.html#method-i-keys">keys</a> to the
list of key paths.</p>
<ul><li>
<p><tt>keys</tt> is a list of file paths to private <a
href="Hop.html#method-i-keys">keys</a></p>
</li></ul>

<p>Returns the instance of <a href="Box.html">Box</a></p>
            

            
            <div class="method-source-code" id="add_keys-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 204</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_keys</span>(*<span class="ruby-identifier">keys</span>)
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] <span class="ruby-operator">||=</span> []
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>].<span class="ruby-identifier">uniq!</span>
  <span class="ruby-keyword">self</span> <span class="ruby-comment"># MUST RETURN self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- add_keys-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="Hop.html#method-i-add_key">add_key</a>
          </div>
          

          
        </div><!-- add_keys-method -->

      
        <div id="connect-method" class="method-detail ">
          <a name="method-i-connect"></a>

          
          <div class="method-heading">
            <span class="method-name">connect</span><span
              class="method-args">(reconnect=true)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Open an SSH session with +@rye_host+. This called automatically when you
the first comamnd is run if it's not already connected. Raises a <a
href="NoHost.html">Rye::NoHost</a> exception if +@rye_host+ is not
specified. Will attempt a password login up to 3 times if the initial 
authentication fails.</p>
<ul><li>
<p><tt>reconnect</tt> Disconnect first if already connected. The default</p>
</li></ul>

<p>is true. When set to false, <a href="Hop.html#method-i-connect">connect</a>
will do nothing if already  connected.</p>
            

            
            <div class="method-source-code" id="connect-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 246</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">connect</span>(<span class="ruby-identifier">reconnect</span>=<span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">NoHost</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_host</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">reconnect</span>
  <span class="ruby-identifier">disconnect</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_ssh</span> 
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_via</span>
    <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Opening connection to #{@rye_host} as #{@rye_user}, via #{@rye_via.host}&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Opening connection to #{@rye_host} as #{@rye_user}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">highline</span> = <span class="ruby-constant">HighLine</span>.<span class="ruby-identifier">new</span> <span class="ruby-comment"># Used for password prompt</span>
  <span class="ruby-identifier">retried</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>].<span class="ruby-identifier">compact!</span>  <span class="ruby-comment"># A quick fix in Windows. TODO: Why is there a nil?</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_via</span>
      <span class="ruby-comment"># tell the +Rye::Hop+ what and where to setup,</span>
      <span class="ruby-comment"># it returns the local port used</span>
      <span class="ruby-ivar">@rye_localport</span> = <span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">fetch_port</span>(<span class="ruby-ivar">@rye_host</span>, <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:port</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-value">22</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:port</span>] )
      <span class="ruby-ivar">@rye_ssh</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span>.<span class="ruby-identifier">start</span>(<span class="ruby-string">&quot;localhost&quot;</span>, <span class="ruby-ivar">@rye_user</span>, <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@rye_localport</span>) <span class="ruby-operator">||</span> {}) 
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rye_ssh</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span>.<span class="ruby-identifier">start</span>(<span class="ruby-ivar">@rye_host</span>, <span class="ruby-ivar">@rye_user</span>, <span class="ruby-ivar">@rye_opts</span> <span class="ruby-operator">||</span> {}) 
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">debug</span> <span class="ruby-string">&quot;starting the port forward thread&quot;</span>
    <span class="ruby-identifier">port_loop</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">HostKeyMismatch</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">message</span>
    <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;\a&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-comment"># Ring the bell</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">highline</span>.<span class="ruby-identifier">ask</span>(<span class="ruby-string">&quot;Continue? &quot;</span>).<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">match</span>(<span class="ruby-regexp">/\Ay|yes|sure|ya\z/</span>)
      <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:paranoid</span>] = <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">retry</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">HostKeyMismatch</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">AuthenticationFailed</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>
    <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;\a&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">retried</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rye_info</span> <span class="ruby-comment"># Ring the bell once</span>
    <span class="ruby-identifier">retried</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">STDIN</span>.<span class="ruby-identifier">tty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">retried</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>
      <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Passwordless login failed for #{@rye_user}&quot;</span>
      <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:password</span>] = <span class="ruby-identifier">highline</span>.<span class="ruby-identifier">ask</span>(<span class="ruby-string">&quot;Password: &quot;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">q</span><span class="ruby-operator">|</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">echo</span> = <span class="ruby-string">''</span> }.<span class="ruby-identifier">strip</span>
      <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:auth_methods</span>] <span class="ruby-operator">||=</span> []
      <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:auth_methods</span>].<span class="ruby-identifier">push</span> *[<span class="ruby-string">'keyboard-interactive'</span>, <span class="ruby-string">'password'</span>]
      <span class="ruby-keyword">retry</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">AuthenticationFailed</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-comment"># We add :auth_methods (a Net::SSH joint) to force asking for a</span>
  <span class="ruby-comment"># password if the initial (key-based) authentication fails. We</span>
  <span class="ruby-comment"># need to delete the key from @rye_opts otherwise it lingers until</span>
  <span class="ruby-comment"># the next connection (if we switch_user is called for example).</span>
  <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value">:auth_methods</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_opts</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:auth_methods</span>)
  
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- connect-source -->
            
          </div>

          

          
        </div><!-- connect-method -->

      
        <div id="debug-3F-method" class="method-detail ">
          <a name="method-i-debug-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">debug?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="debug-3F-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">debug?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_debug</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- debug-3F-source -->
            
          </div>

          

          
        </div><!-- debug-3F-method -->

      
        <div id="disconnect-method" class="method-detail ">
          <a name="method-i-disconnect"></a>

          
          <div class="method-heading">
            <span class="method-name">disconnect</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Close the SSH session  with +@rye_host+. This is called  automatically at
exit if the connection is open.</p>
            

            
            <div class="method-source-code" id="disconnect-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 317</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">disconnect</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">closed?</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">debug</span> <span class="ruby-string">&quot;removing active forwards&quot;</span>
    <span class="ruby-identifier">remove_hops!</span>
    <span class="ruby-identifier">debug</span> <span class="ruby-string">&quot;killing port_loop @rye_port_thread&quot;</span>
    <span class="ruby-ivar">@rye_port_thread</span>.<span class="ruby-identifier">kill</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">busy?</span>;
      <span class="ruby-identifier">info</span> <span class="ruby-string">&quot;Is something still running? (ctrl-C to exit)&quot;</span>
      <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-identifier">timeout</span>(<span class="ruby-value">10</span>) <span class="ruby-keyword">do</span>
        <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">loop</span>(<span class="ruby-value">0.3</span>) { <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">busy?</span>; }
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;Closing connection to #{@rye_ssh.host}&quot;</span>
    <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rye_via</span>
      <span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;disconnecting Hop #{@rye_via.host}&quot;</span>
      <span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">disconnect</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>
    <span class="ruby-identifier">error</span> <span class="ruby-node">&quot;Rye::Hop: Disconnect timeout (#{ex.message})&quot;</span>
    <span class="ruby-identifier">debug</span> <span class="ruby-identifier">ex</span>.<span class="ruby-identifier">backtrace</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Interrupt</span>
    <span class="ruby-identifier">debug</span> <span class="ruby-string">&quot;Exiting...&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- disconnect-source -->
            
          </div>

          

          
        </div><!-- disconnect-method -->

      
        <div id="error-3F-method" class="method-detail ">
          <a name="method-i-error-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">error?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="error-3F-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">error?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_error</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- error-3F-source -->
            
          </div>

          

          
        </div><!-- error-3F-method -->

      
        <div id="exception_hook-3D-method" class="method-detail ">
          <a name="method-i-exception_hook-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">exception_hook=</span><span
              class="method-args">(val)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>A Hash. The <a href="Hop.html#method-i-keys">keys</a> are exception
classes, the values are Procs to execute</p>
            

            
            <div class="method-source-code" id="exception_hook-3D-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">exception_hook=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_exception_hook</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- exception_hook-3D-source -->
            
          </div>

          

          
        </div><!-- exception_hook-3D-method -->

      
        <div id="fetch_port-method" class="method-detail ">
          <a name="method-i-fetch_port"></a>

          
          <div class="method-heading">
            <span class="method-name">fetch_port</span><span
              class="method-args">(host, port = 22, localport = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>instance method, that will setup a forward, and return the port used</p>
            

            
            <div class="method-source-code" id="fetch_port-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 181</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fetch_port</span>(<span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span> = <span class="ruby-value">22</span>, <span class="ruby-identifier">localport</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">connect</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_ssh</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">localport</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">port_used</span> = <span class="ruby-identifier">next_port</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">port_used</span> = <span class="ruby-identifier">localport</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># i would like to check if the port and host </span>
  <span class="ruby-comment"># are already an active_locals forward, but that </span>
  <span class="ruby-comment"># info does not get returned, and trusting the localport</span>
  <span class="ruby-comment"># is not enough information, so lets just set up a new one</span>
  <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">port_used</span>, <span class="ruby-identifier">host</span>, <span class="ruby-identifier">port</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">port_used</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- fetch_port-source -->
            
          </div>

          

          
        </div><!-- fetch_port-method -->

      
        <div id="host-method" class="method-detail ">
          <a name="method-i-host"></a>

          
          <div class="method-heading">
            <span class="method-name">host</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="host-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 39</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">host</span>; <span class="ruby-ivar">@rye_host</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- host-source -->
            
          </div>

          

          
        </div><!-- host-method -->

      
        <div id="host-3D-method" class="method-detail ">
          <a name="method-i-host-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">host=</span><span
              class="method-args">(val)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="host-3D-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">host=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_host</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- host-3D-source -->
            
          </div>

          

          
        </div><!-- host-3D-method -->

      
        <div id="host_key-method" class="method-detail ">
          <a name="method-i-host_key"></a>

          
          <div class="method-heading">
            <span class="method-name">host_key</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the <a href="Hop.html#method-i-host">host</a> SSH <a
href="Hop.html#method-i-keys">keys</a> for this box</p>
            

            
            <div class="method-source-code" id="host_key-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 366</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">host_key</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;No host&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_host</span>
  <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">remote_host_keys</span>(<span class="ruby-ivar">@rye_host</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- host_key-source -->
            
          </div>

          

          
        </div><!-- host_key-method -->

      
        <div id="info-3F-method" class="method-detail ">
          <a name="method-i-info-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">info?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="info-3F-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 53</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">info?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_info</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- info-3F-source -->
            
          </div>

          

          
        </div><!-- info-3F-method -->

      
        <div id="inspect-method" class="method-detail ">
          <a name="method-i-inspect"></a>

          
          <div class="method-heading">
            <span class="method-name">inspect</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="inspect-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 350</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>
  <span class="ruby-string">%{#&lt;%s:%s name=%s cwd=%s umask=%s env=%s via=%s opts=%s keys=%s&gt;}</span> <span class="ruby-operator">%</span> 
  [<span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nickname</span>,
   <span class="ruby-ivar">@rye_current_working_directory</span>, <span class="ruby-ivar">@rye_current_umask</span>,
   (<span class="ruby-ivar">@rye_current_environment_variables</span> <span class="ruby-operator">||</span> <span class="ruby-string">''</span>).<span class="ruby-identifier">inspect</span>,
   (<span class="ruby-ivar">@rye_via</span> <span class="ruby-operator">||</span> <span class="ruby-string">''</span>).<span class="ruby-identifier">inspect</span>,
   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">inspect</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">inspect</span>]
<span class="ruby-keyword">end</span></pre>
            </div><!-- inspect-source -->
            
          </div>

          

          
        </div><!-- inspect-method -->

      
        <div id="keys-method" class="method-detail ">
          <a name="method-i-keys"></a>

          
          <div class="method-heading">
            <span class="method-name">keys</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>See <a href="../Rye.html#method-i-keys">Rye.keys</a></p>
            

            
            <div class="method-source-code" id="keys-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 345</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">keys</span>; <span class="ruby-constant">Rye</span>.<span class="ruby-identifier">keys</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- keys-source -->
            
          </div>

          

          
        </div><!-- keys-method -->

      
        <div id="nickname-method" class="method-detail ">
          <a name="method-i-nickname"></a>

          
          <div class="method-heading">
            <span class="method-name">nickname</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="nickname-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">nickname</span>; <span class="ruby-ivar">@rye_nickname</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">host</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- nickname-source -->
            
          </div>

          

          
        </div><!-- nickname-method -->

      
        <div id="nickname-3D-method" class="method-detail ">
          <a name="method-i-nickname-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">nickname=</span><span
              class="method-args">(val)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="nickname-3D-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">nickname=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_nickname</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- nickname-3D-source -->
            
          </div>

          

          
        </div><!-- nickname-3D-method -->

      
        <div id="opts-method" class="method-detail ">
          <a name="method-i-opts"></a>

          
          <div class="method-heading">
            <span class="method-name">opts</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="opts-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">opts</span>; <span class="ruby-ivar">@rye_opts</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- opts-source -->
            
          </div>

          

          
        </div><!-- opts-method -->

      
        <div id="opts-3D-method" class="method-detail ">
          <a name="method-i-opts-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">opts=</span><span
              class="method-args">(val)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="opts-3D-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 49</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">opts=</span>(<span class="ruby-identifier">val</span>); <span class="ruby-ivar">@rye_opts</span> = <span class="ruby-identifier">val</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- opts-3D-source -->
            
          </div>

          

          
        </div><!-- opts-3D-method -->

      
        <div id="remove_hops-21-method" class="method-detail ">
          <a name="method-i-remove_hops-21"></a>

          
          <div class="method-heading">
            <span class="method-name">remove_hops!</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Cancel the port forward on all active local forwards</p>
            

            
            <div class="method-source-code" id="remove_hops-21-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 302</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_hops!</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@rye_ssh</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
  <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">fport</span>, <span class="ruby-identifier">fhost</span><span class="ruby-operator">|</span> 
    <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">cancel_local</span>(<span class="ruby-identifier">fport</span>, <span class="ruby-identifier">fhost</span>)
  }
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">channels</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">channel</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">channel</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">close</span>
    }
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@rye_ssh</span>.<span class="ruby-identifier">forward</span>.<span class="ruby-identifier">active_locals</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- remove_hops-21-source -->
            
          </div>

          

          
        </div><!-- remove_hops-21-method -->

      
        <div id="remove_key-method" class="method-detail method-alias">
          <a name="method-i-remove_key"></a>

          
          <div class="method-heading">
            <span class="method-name">remove_key</span><span
              class="method-args">(*keys)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="Hop.html#method-i-remove_keys">remove_keys</a>
          </div>
          
        </div><!-- remove_key-method -->

      
        <div id="remove_keys-method" class="method-detail ">
          <a name="method-i-remove_keys"></a>

          
          <div class="method-heading">
            <span class="method-name">remove_keys</span><span
              class="method-args">(*keys)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Remove one or more private <a href="Hop.html#method-i-keys">keys</a> fromt
he list of key paths.</p>
<ul><li>
<p><tt>keys</tt> is a list of file paths to private <a
href="Hop.html#method-i-keys">keys</a></p>
</li></ul>

<p>Returns the instance of <a href="Box.html">Box</a></p>
            

            
            <div class="method-source-code" id="remove_keys-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 215</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_keys</span>(*<span class="ruby-identifier">keys</span>)
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] <span class="ruby-operator">||=</span> []
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>] <span class="ruby-operator">-=</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>
  <span class="ruby-ivar">@rye_opts</span>[<span class="ruby-value">:keys</span>].<span class="ruby-identifier">uniq!</span>
  <span class="ruby-keyword">self</span> <span class="ruby-comment"># MUST RETURN self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- remove_keys-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="Hop.html#method-i-remove_key">remove_key</a>
          </div>
          

          
        </div><!-- remove_keys-method -->

      
        <div id="root-3F-method" class="method-detail ">
          <a name="method-i-root-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">root?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="root-3F-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 42</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">root?</span>; <span class="ruby-identifier">user</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;root&quot;</span> <span class="ruby-keyword">end</span></pre>
            </div><!-- root-3F-source -->
            
          </div>

          

          
        </div><!-- root-3F-method -->

      
        <div id="ssh_config_options-method" class="method-detail ">
          <a name="method-i-ssh_config_options"></a>

          
          <div class="method-heading">
            <span class="method-name">ssh_config_options</span><span
              class="method-args">(host)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Parse SSH config files for use with Net::SSH</p>
            

            
            <div class="method-source-code" id="ssh_config_options-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 197</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ssh_config_options</span>(<span class="ruby-identifier">host</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Config</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">host</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- ssh_config_options-source -->
            
          </div>

          

          
        </div><!-- ssh_config_options-method -->

      
        <div id="switch_user-method" class="method-detail ">
          <a name="method-i-switch_user"></a>

          
          <div class="method-heading">
            <span class="method-name">switch_user</span><span
              class="method-args">(newuser)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Reconnect as another <a href="Hop.html#method-i-user">user</a>. This is
different from su= which executes subsequent commands <a
href="Hop.html#method-i-via">via</a> +su -c COMMAND USER+.</p>
<ul><li>
<p><tt>newuser</tt> The username to reconnect as</p>
</li></ul>

<p>NOTE: if there is an open connection, it's disconnected but not reconnected
because it's possible it wasn't  connected yet in the first place (if you
create the  instance with default settings for example)</p>
            

            
            <div class="method-source-code" id="switch_user-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">switch_user</span>(<span class="ruby-identifier">newuser</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">newuser</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-ivar">@rye_opts</span> <span class="ruby-operator">||=</span> {}
  <span class="ruby-ivar">@rye_user</span> = <span class="ruby-identifier">newuser</span>
  <span class="ruby-identifier">disconnect</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- switch_user-source -->
            
          </div>

          

          
        </div><!-- switch_user-method -->

      
        <div id="to_s-method" class="method-detail ">
          <a name="method-i-to_s"></a>

          
          <div class="method-heading">
            <span class="method-name">to_s</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns +<a href="Hop.html#method-i-user">user</a>@rye_host+</p>
            

            
            <div class="method-source-code" id="to_s-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 348</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>; <span class="ruby-string">'%s@rye_%s'</span> <span class="ruby-operator">%</span> [<span class="ruby-identifier">user</span>, <span class="ruby-ivar">@rye_host</span>]; <span class="ruby-keyword">end</span></pre>
            </div><!-- to_s-source -->
            
          </div>

          

          
        </div><!-- to_s-method -->

      
        <div id="user-method" class="method-detail ">
          <a name="method-i-user"></a>

          
          <div class="method-heading">
            <span class="method-name">user</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="user-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 41</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">user</span>; <span class="ruby-ivar">@rye_user</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- user-source -->
            
          </div>

          

          
        </div><!-- user-method -->

      
        <div id="via-method" class="method-detail ">
          <a name="method-i-via"></a>

          
          <div class="method-heading">
            <span class="method-name">via</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="via-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 45</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">via</span>; <span class="ruby-ivar">@rye_via</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- via-source -->
            
          </div>

          

          
        </div><!-- via-method -->

      
        <div id="via-3F-method" class="method-detail ">
          <a name="method-i-via-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">via?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="via-3F-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 52</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">via?</span>; <span class="ruby-operator">!</span><span class="ruby-ivar">@rye_via</span>.<span class="ruby-identifier">nil?</span>; <span class="ruby-keyword">end</span></pre>
            </div><!-- via-3F-source -->
            
          </div>

          

          
        </div><!-- via-3F-method -->

      
        <div id="via_hop-method" class="method-detail ">
          <a name="method-i-via_hop"></a>

          
          <div class="method-heading">
            <span class="method-name">via_hop</span><span
              class="method-args">(*hops)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <ul><li>
<p><tt>hops</tt> <a href="Hop.html">Rye::Hop</a> objects will be added
directly</p>
</li></ul>

<p>to the set. Hostnames will be used to create <a
href="Hop.html#method-c-new">new</a> instances of <a
href="Hop.html">Rye::Hop</a>  h1 = <a
href="Hop.html#method-c-new">Rye::Hop.new</a> "host1" h1.<a
href="Hop.html#method-i-via_hop">via_hop</a> "host2", :<a
href="Hop.html#method-i-user">user</a> =&gt; "service_user"</p>

<p>OR</p>

<p>h1 = <a href="Hop.html#method-c-new">Rye::Hop.new</a> "host1" h2 = <a
href="Hop.html#method-c-new">Rye::Hop.new</a> "host2" h1.<a
href="Hop.html#method-i-via_hop">via_hop</a> h2</p>
            

            
            <div class="method-source-code" id="via_hop-source">
<pre>
<span class="ruby-comment"># File lib/rye/hop.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">via_hop</span>(*<span class="ruby-identifier">hops</span>)
  <span class="ruby-identifier">hops</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span> 
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-ivar">@rye_via</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>)
    <span class="ruby-ivar">@rye_via</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
    <span class="ruby-identifier">hop</span> = <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">shift</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-ivar">@rye_via</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hop</span>, <span class="ruby-identifier">hops</span>.<span class="ruby-identifier">first</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rye_via</span> = <span class="ruby-constant">Rye</span><span class="ruby-operator">::</span><span class="ruby-constant">Hop</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hop</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">disconnect</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- via_hop-source -->
            
          </div>

          

          
        </div><!-- via_hop-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

